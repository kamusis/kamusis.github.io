<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme-color" content=#58b77a>
  <title>Kamus&#39; Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Kamus">
  <meta name="keywords" content="openGauss, MogDB, databases, macOS, Windows, Docker, Linux, cloud-native">
  <meta name="description" content="Expert insights and practical tips on openGauss, MogDB, Oracle, Linux, and cloud-native technologies. Elevate your database management and system administration skills with in-depth technical articles, tutorials, and best practices for real-world challenges.">
  <script id="hexo-configurations">
  var CONFIG = {
    root: '/',
    theme: 'lx',
    version: '0.4.4',
    localsearch:{
      "enable": true,
      "trigger": "auto",
      "top_n_per_article": 1,
      "unescape": false,
      "preload": false
      },
    path: 'search.xml'
  };
</script>

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/theme-lx@0.4.4/source/dist/css/main.min.css">
  
  <style type="text/css">
    pre,
    code {
      font-family: 'Fira Code', monospace;
    }
    html {
      font-family: sans-serif;
    }
    body {
      font-family: sans-serif;
    }
    h1, h2, h3, h4, h5, figure {
      font-family: sans-serif;
    }
    .menu-container{
      font-family: sans-serif;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/theme-lx@0.4.4/source/dist/js/jquery.jside.menu.min.js"></script>
	<script>
	$(document).ready(function(){
	$(".menu-container").jSideMenu({
	    jSidePosition: "position-right",
	    jSideSticky: true,
	    jSideSkin: "",
	     });
	}); 
	</script>
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">

<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="Kamus' Notes" type="application/atom+xml">
</head>
<body>
<div id="page">
<div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Search..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>

<div class="header">
  <div id="lx-aside" style="background-image: url(https://cdn.jsdelivr.net/npm/theme-lx@0.4.4/source/dist/images/cover.min.jpeg)">
    <div class="overlay">
      <a href="javascript:;" class="popup-trigger" title="search"><i class="menu-item-icon fa fa-search fa-fw"></i></a>
      <div class="featured">
        <div class="avatar"><a href="/"><img src="https://s2.loli.net/2024/05/27/nuGfQUOx6kR9YIh.png" alt="Kamus"></a></div>
        <span>Kamus</span>
        <h1>Kamus' Notes</h1>
        <span>面朝大海，春暖花开</span>
        <div class="social-links">
    <a href="https://github.com/kamusis" target="_blank" title="social-link"><i class="fa fa-github fa-fw"></i></a>
    <a href="mailto:kamusis@gmail.com" target="_blank" title="social-link"><i class="fa fa-envelope fa-fw"></i></a>
    <a href="https://www.linkedin.com/in/kamus/" target="_blank" title="social-link"><i class="fa fa-linkedin fa-fw"></i></a>
    <a href="https://twitter.com/kamusis" target="_blank" title="social-link"><i class="fa fa-twitter fa-fw"></i></a>
    <a href="https://www.instagram.com/kamusis/" target="_blank" title="social-link"><i class="fa fa-instagram fa-fw"></i></a>
</div>
      </div>
    </div>
  </div>
</div>
<div id="lx-main-content">
  <div class="lx-post">

  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2025/04/08/From-Software-Search-to-Code-Generation-The-Agentic-Coding-Revolution/">From Software Search to Code Generation: The Agentic Coding Revolution</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2025-04-08</span>
      <p><h2 id="User-Story-RSS-Feed-Clean-up-Journey"><a href="#User-Story-RSS-Feed-Clean-up-Journey" class="headerlink" title="User Story: RSS Feed Clean-up Journey"></a>User Story: RSS Feed Clean-up Journey</h2><p>Over the past 15 years, I’ve accumulated a substantial collection of RSS feeds, numbering over 200 subscriptions. While RSS usage has dramatically declined in recent years, some of these feeds remain part of my daily reading routine. However, the collection has become cluttered:</p>
<ul>
<li>Many feeds have become completely inaccessible</li>
<li>Some bloggers have stopped updating their sites</li>
<li>Certain feeds are still active but rarely updated</li>
</ul>
<p><strong>The Challenge:</strong></p>
<ul>
<li>Manual verification of each feed would be tedious and time-consuming</li>
<li>My RSS reader (News Explorer) lacks feed cleanup functionality</li>
<li>Alternative solutions like Inoreader require paid subscriptions</li>
<li>The task remained pending due to lack of efficient solutions</li>
</ul>
<p><strong>The Agentic Coding Solution:</strong><br>What was previously a daunting task transformed into a manageable project:</p>
<ul>
<li>Total time from requirement writing to completion: ~2 hours</li>
<li>Automated validation of all feeds</li>
<li>Generated comprehensive statistics and visualizations</li>
<li>Successfully categorized feeds into active, inactive, and dead</li>
<li>Pleasant and efficient development experience</li>
</ul>
<p>This experience perfectly illustrates how agentic coding can turn a long-postponed task into an achievable solution through clear requirement description and AI-assisted development.</p>
<h2 id="The-Traditional-Approach"><a href="#The-Traditional-Approach" class="headerlink" title="The Traditional Approach"></a>The Traditional Approach</h2><p>Traditionally, when faced with a specific requirement like validating and analyzing OPML feed subscriptions, the typical workflow would be:</p>
<ol>
<li>Search for existing software that might solve the problem</li>
<li>Evaluate multiple tools and their features</li>
<li>Choose the closest match, often compromising on exact requirements</li>
<li>Learn how to use the chosen software</li>
<li>Deal with limitations and missing features</li>
</ol>
<p>This process is time-consuming and often results in settling for a solution that doesn’t perfectly match our needs.</p>
<h2 id="The-Agentic-Coding-Paradigm"><a href="#The-Agentic-Coding-Paradigm" class="headerlink" title="The Agentic Coding Paradigm"></a>The Agentic Coding Paradigm</h2><p>With agentic coding, the approach transforms dramatically:</p>
<ol>
<li>Clearly describe your requirements in natural language</li>
<li>Let AI understand and break down the problem</li>
<li>Generate custom code that exactly matches your needs</li>
<li>Iterate and refine the solution through conversation</li>
</ol>
<h3 id="Real-World-Example-OPML-Feed-Validator"><a href="#Real-World-Example-OPML-Feed-Validator" class="headerlink" title="Real-World Example: OPML Feed Validator"></a>Real-World Example: OPML Feed Validator</h3><p>This project demonstrates the power of agentic coding. Instead of searching for an existing OPML feed validator:</p>
<ul>
<li><p>We described our need for a tool that could:</p>
<ul>
<li>Validate RSS feeds in an OPML file</li>
<li>Check feed accessibility</li>
<li>Analyze update frequencies</li>
<li>Generate meaningful statistics</li>
<li>Visualize the results</li>
</ul>
</li>
<li><p>The AI agent:</p>
<ul>
<li>Designed the system architecture</li>
<li>Implemented the required functionality</li>
<li>Created visualization components</li>
<li>Generated comprehensive documentation</li>
<li>All while following best practices and proper error handling</li>
</ul>
</li>
</ul>
<h2 id="Benefits-of-Agentic-Coding"><a href="#Benefits-of-Agentic-Coding" class="headerlink" title="Benefits of Agentic Coding"></a>Benefits of Agentic Coding</h2><ol>
<li><strong>Perfect Fit</strong>: Solutions are tailored exactly to your requirements</li>
<li><strong>Rapid Development</strong>: No need to spend time searching and evaluating existing tools</li>
<li><strong>Full Control</strong>: Complete access to the source code for modifications</li>
<li><strong>Learning Opportunity</strong>: Understanding how the solution works through generated code</li>
<li><strong>Cost-Effective</strong>: No need to purchase or subscribe to multiple tools</li>
<li><strong>Maintenance Freedom</strong>: Ability to modify and extend the solution as needs evolve</li>
</ol>
<h2 id="Future-Implications"><a href="#Future-Implications" class="headerlink" title="Future Implications"></a>Future Implications</h2><p>This shift from “finding” to “generating” solutions represents a fundamental change in how we approach software development. As AI continues to evolve:</p>
<ul>
<li>Development will become more requirement-driven than tool-driven</li>
<li>Custom solutions will become as accessible as off-the-shelf software</li>
<li>The focus will shift from “what exists” to “what’s possible”</li>
</ul>
<p>Agentic coding empowers developers and users alike to create exactly what they need, breaking free from the limitations of existing software solutions.</p>
<h2 id="Lessons-Learned-and-Experience"><a href="#Lessons-Learned-and-Experience" class="headerlink" title="Lessons Learned and Experience"></a>Lessons Learned and Experience</h2><h3 id="1-The-Importance-of-Clear-Requirements"><a href="#1-The-Importance-of-Clear-Requirements" class="headerlink" title="1. The Importance of Clear Requirements"></a>1. The Importance of Clear Requirements</h3><p>Product thinking and clear requirements are crucial for successful AI-assisted development:</p>
<ul>
<li><strong>Clear Vision Leads to Better Code</strong>: When requirements are well-defined and specific about how the tool should behave, the AI generates higher quality code</li>
<li><strong>Product Mindset</strong>: Requirement providers need to have a clear understanding of:<ul>
<li>Desired user interactions</li>
<li>Expected outputs and their formats</li>
<li>Error handling scenarios</li>
<li>Performance expectations</li>
</ul>
</li>
<li><strong>Iterative Refinement</strong>: Unclear requirements often lead to multiple iterations and code quality issues</li>
</ul>
<h3 id="2-Technology-Stack-Selection-Matters"><a href="#2-Technology-Stack-Selection-Matters" class="headerlink" title="2. Technology Stack Selection Matters"></a>2. Technology Stack Selection Matters</h3><p>The choice of programming languages and libraries significantly impacts AI-assisted development success:</p>
<ul>
<li><p><strong>Language Popularity Impact</strong>:</p>
<ul>
<li>More widely used languages (like Python) often result in better AI-generated code</li>
<li>Popular languages have more training data and real-world examples</li>
<li>In this project, while we chose TypeScript with Deno for learning purposes, Python might have been an easier choice</li>
</ul>
</li>
<li><p><strong>Library Selection Strategy</strong>:</p>
<ul>
<li>Popular, widely-used libraries lead to better AI comprehension and implementation</li>
<li>Example from this project:<ul>
<li>Initial attempt: Using less common <code>deno_chart</code> library resulted in multiple errors</li>
<li>Successful pivot: Switching to standard SVG generation led to immediate success</li>
</ul>
</li>
<li>Lesson: Prefer mainstream libraries over niche ones when working with AI</li>
</ul>
</li>
</ul>
<h3 id="Best-Practices-for-AI-Assisted-Development"><a href="#Best-Practices-for-AI-Assisted-Development" class="headerlink" title="Best Practices for AI-Assisted Development"></a>Best Practices for AI-Assisted Development</h3><ol>
<li><p><strong>Requirements Phase</strong>:</p>
<ul>
<li>Invest time in detailed requirement documentation</li>
<li>Include specific examples of desired behavior</li>
<li>Define clear success criteria</li>
</ul>
</li>
<li><p><strong>Technology Selection</strong>:</p>
<ul>
<li>Consider language popularity and ecosystem maturity</li>
<li>Choose widely-adopted libraries when possible</li>
<li>Balance learning goals with development efficiency</li>
</ul>
</li>
<li><p><strong>Development Process</strong>:</p>
<ul>
<li>Start with core functionality using proven technologies</li>
<li>Experiment with newer technologies only after basic features are stable</li>
<li>Be prepared to pivot when encountering AI limitations with specific technologies</li>
</ul>
</li>
</ol>
<p>This project serves as a practical example of these lessons, demonstrating both the potential and limitations of AI-assisted development while highlighting the importance of making informed technology choices.</p>
<p>The project can be found <a target="_blank" rel="noopener" href="https://github.com/kamusis/my-opml-subscriptions">here</a>.</p>
</p>
      <div class="post-button"><a class="btn" href="/2025/04/08/From-Software-Search-to-Code-Generation-The-Agentic-Coding-Revolution/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2025/03/28/Getting-Started-with-Deno-A-Modern-Twist-on-JavaScript-Runtimes/">Getting Started with Deno: A Modern Twist on JavaScript Runtimes</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2025-03-28</span>
      <p><p>If you’ve been in the JavaScript world for a while, you’ve probably heard of Deno—the runtime that’s been making waves as a “better Node.js.” Built by Ryan Dahl (the original creator of Node.js), Deno takes a fresh approach to running JavaScript and TypeScript, aiming to fix some of Node’s pain points while embracing modern standards. In this post, I’ll walk you through what Deno is, how it works, and how it stacks up against Node.js—especially based on my recent dive into it while tinkering with a Supabase integration.</p>
<h2 id="What-is-Deno"><a href="#What-is-Deno" class="headerlink" title="What is Deno?"></a>What is Deno?</h2><p>Deno is a secure, modern runtime for JavaScript and TypeScript, launched in 2020. It’s designed to be simple, safe, and developer-friendly, with built-in support for TypeScript, ES Modules, and a standard library—no extra tools required. Think of it as Node.js reimagined with lessons learned from the past decade.</p>
<p>Here’s a quick taste of Deno in action:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; serve &#125; <span class="keyword">from</span> <span class="string">&quot;https://deno.land/std@0.224.0/http/server.ts&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">serve</span>(<span class="function">(<span class="params">req</span>) =&gt;</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&quot;Hello, Deno!&quot;</span>), &#123; <span class="attr">port</span>: <span class="number">8000</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>Run it with:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run --allow-net main.ts</span><br></pre></td></tr></table></figure>
<p>Boom—a web server in three lines, no <code>npm install</code> or <code>node_modules</code> in sight.</p>
<h2 id="Key-Features-of-Deno"><a href="#Key-Features-of-Deno" class="headerlink" title="Key Features of Deno"></a>Key Features of Deno</h2><h3 id="1-TypeScript-Out-of-the-Box"><a href="#1-TypeScript-Out-of-the-Box" class="headerlink" title="1. TypeScript Out of the Box"></a>1. TypeScript Out of the Box</h3><p>Deno runs TypeScript natively—no <code>tsconfig.json</code> or <code>tsc</code> needed. Write your <code>.ts</code> file, run it with <code>deno run</code>, and Deno compiles it in memory. Compare that to Node.js, where you’d need <code>typescript</code> installed and a build step (or <code>ts-node</code> for a quicker dev loop).</p>
<h3 id="2-URL-Based-Imports"><a href="#2-URL-Based-Imports" class="headerlink" title="2. URL-Based Imports"></a>2. URL-Based Imports</h3><p>Forget <code>node_modules</code>. Deno fetches dependencies from URLs:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; load &#125; <span class="keyword">from</span> <span class="string">&quot;https://deno.land/std@0.224.0/dotenv/mod.ts&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>It caches them globally (more on that later) and skips the package manager entirely.</p>
<h3 id="3-Security-by-Default"><a href="#3-Security-by-Default" class="headerlink" title="3. Security by Default"></a>3. Security by Default</h3><p>Deno won’t let your script touch the network, filesystem, or environment unless you explicitly allow it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run --allow-env --allow-read main.ts</span><br></pre></td></tr></table></figure>
<p>This is a stark contrast to Node.js, where scripts have free rein unless you sandbox them yourself.</p>
<h3 id="4-Centralized-Dependency-Cache"><a href="#4-Centralized-Dependency-Cache" class="headerlink" title="4. Centralized Dependency Cache"></a>4. Centralized Dependency Cache</h3><p>Deno stores all dependencies in a single global cache (e.g., <code>~/.cache/deno/deps</code> on Unix). Run <code>deno info</code> to see where:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deno info</span><br><span class="line"><span class="comment"># Outputs: Modules cache: &quot;/home/username/.cache/deno/deps&quot;</span></span><br></pre></td></tr></table></figure>
<p>No per-project <code>node_modules</code> bloating your disk.</p>
<h3 id="5-Standard-Library"><a href="#5-Standard-Library" class="headerlink" title="5. Standard Library"></a>5. Standard Library</h3><p>Deno ships with a curated <code>std</code> library (e.g., <code>https://deno.land/std@0.224.0</code>), covering HTTP servers, file I&#x2F;O, and even a <code>dotenv</code> module for <code>.env</code> files—stuff you’d normally grab from npm in Node.js.</p>
<h2 id="Deno-vs-Node-js-A-Head-to-Head-Comparison"><a href="#Deno-vs-Node-js-A-Head-to-Head-Comparison" class="headerlink" title="Deno vs. Node.js: A Head-to-Head Comparison"></a>Deno vs. Node.js: A Head-to-Head Comparison</h2><p>I recently played with Deno to connect to Supabase, and it highlighted some big differences from Node.js. Here’s how they stack up:</p>
<h3 id="Dependency-Management"><a href="#Dependency-Management" class="headerlink" title="Dependency Management"></a>Dependency Management</h3><ul>
<li><strong>Node.js</strong>: Uses <code>npm</code> and <code>package.json</code> to install dependencies into a local <code>node_modules</code> folder per project. Cloning a repo? Run <code>npm install</code> every time.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @supabase/supabase-js</span><br></pre></td></tr></table></figure></li>
<li><strong>Deno</strong>: Imports modules via URLs, cached globally at <code>~/.cache/deno/deps</code>. Clone a Deno repo, and you’re ready to run—no install step.<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createClient &#125; <span class="keyword">from</span> <span class="string">&quot;https://esm.sh/@supabase/supabase-js@2.49.3&quot;</span>;</span><br></pre></td></tr></table></figure></li>
<li><strong>Winner?</strong>: Deno for simplicity, Node.js for isolation (different projects can use different versions of the same module without URL juggling).</li>
</ul>
<h3 id="TypeScript-Support"><a href="#TypeScript-Support" class="headerlink" title="TypeScript Support"></a>TypeScript Support</h3><ul>
<li><strong>Node.js</strong>: Requires setup—install <code>typescript</code>, configure <code>tsconfig.json</code>, and compile to JavaScript (or use <code>ts-node</code>). It’s mature but clunky.</li>
<li><strong>Deno</strong>: TypeScript runs natively. No config, no build step. Write <code>.ts</code> and go.</li>
<li><strong>Winner</strong>: Deno, hands down, unless you’re stuck on a legacy Node.js workflow.</li>
</ul>
<h3 id="Configuration-Files"><a href="#Configuration-Files" class="headerlink" title="Configuration Files"></a>Configuration Files</h3><ul>
<li><strong>Node.js</strong>: Relies on <code>package.json</code> for dependencies and scripts, often paired with <code>tsconfig.json</code> for TypeScript.</li>
<li><strong>Deno</strong>: Optional <code>deno.json</code> for imports and settings, but not required. My Supabase script didn’t need one—just a <code>.env</code> file and <code>std/dotenv</code>.</li>
<li><strong>Winner</strong>: Deno for minimalism.</li>
</ul>
<h3 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h3><ul>
<li><strong>Node.js</strong>: Open by default. Your script can read files or hit the network without warning.</li>
<li><strong>Deno</strong>: Locked down. Want to read <code>.env</code>? Add <code>--allow-read</code>. Network access? <code>--allow-net</code>. It forced me to think about permissions when connecting to Supabase.</li>
<li><strong>Winner</strong>: Deno for safety.</li>
</ul>
<h3 id="Ecosystem"><a href="#Ecosystem" class="headerlink" title="Ecosystem"></a>Ecosystem</h3><ul>
<li><strong>Node.js</strong>: Massive npm ecosystem—hundreds of thousands of packages. Whatever you need, it’s there.</li>
<li><strong>Deno</strong>: Smaller but growing ecosystem via <code>deno.land/x</code> and CDNs like <code>esm.sh</code>. It worked fine for Supabase, but niche libraries might be missing.</li>
<li><strong>Winner</strong>: Node.js for sheer volume.</li>
</ul>
<h3 id="Learning-Curve"><a href="#Learning-Curve" class="headerlink" title="Learning Curve"></a>Learning Curve</h3><ul>
<li><strong>Node.js</strong>: Familiar to most JavaScript devs, but the setup (npm, TypeScript, etc.) can overwhelm beginners.</li>
<li><strong>Deno</strong>: Fresh approach, but URL imports and permissions might feel alien if you’re Node.js-native.</li>
<li><strong>Winner</strong>: Tie—depends on your background.</li>
</ul>
<h2 id="A-Real-World-Example-Supabase-with-Deno"><a href="#A-Real-World-Example-Supabase-with-Deno" class="headerlink" title="A Real-World Example: Supabase with Deno"></a>A Real-World Example: Supabase with Deno</h2><p>Here’s how I set up a Supabase client in Deno:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createClient &#125; <span class="keyword">from</span> <span class="string">&quot;https://esm.sh/@supabase/supabase-js@2.49.3&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; load &#125; <span class="keyword">from</span> <span class="string">&quot;https://deno.land/std@0.224.0/dotenv/mod.ts&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> env = <span class="keyword">await</span> <span class="title function_">load</span>(&#123; <span class="attr">envPath</span>: <span class="string">&quot;./.env&quot;</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> supabaseUrl = env[<span class="string">&quot;SUPABASE_URL&quot;</span>] || <span class="title class_">Deno</span>.<span class="property">env</span>.<span class="title function_">get</span>(<span class="string">&quot;SUPABASE_URL&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> supabaseKey = env[<span class="string">&quot;SUPABASE_ANON_KEY&quot;</span>] || <span class="title class_">Deno</span>.<span class="property">env</span>.<span class="title function_">get</span>(<span class="string">&quot;SUPABASE_ANON_KEY&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!supabaseUrl || !supabaseKey) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Missing SUPABASE_URL or SUPABASE_ANON_KEY&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> supabase = <span class="title function_">createClient</span>(supabaseUrl, supabaseKey);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Supabase client created! Attributes:&quot;</span>, <span class="title class_">Object</span>.<span class="title function_">keys</span>(supabase));</span><br></pre></td></tr></table></figure>
<p>Run it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run --allow-env --allow-read main.ts</span><br></pre></td></tr></table></figure>
<ul>
<li><code>.env</code> file: <code>SUPABASE_URL</code> and <code>SUPABASE_ANON_KEY</code> (grabbed from Supabase’s dashboard—<em>not</em> my database password!).</li>
<li>VS Code linting needed the Deno extension and a <code>deno cache main.ts</code> to quiet TypeScript errors.</li>
</ul>
<p>In Node.js, I’d have installed <code>@supabase/supabase-js</code> via npm, set up a <code>dotenv</code> package, and skipped the permissions flags. Deno’s way felt leaner but required tweaking for editor support.</p>
<h2 id="Should-You-Use-Deno"><a href="#Should-You-Use-Deno" class="headerlink" title="Should You Use Deno?"></a>Should You Use Deno?</h2><ul>
<li><strong>Use Deno if</strong>:<ul>
<li>You love TypeScript and hate build steps.</li>
<li>You want a secure, minimal setup for small projects or experiments.</li>
<li>You’re intrigued by a modern take on JavaScript runtimes.</li>
</ul>
</li>
<li><strong>Stick with Node.js if</strong>:<ul>
<li>You need the npm ecosystem’s depth.</li>
<li>You’re working on a legacy project or with a team entrenched in Node.</li>
<li>You prefer per-project dependency isolation.</li>
</ul>
</li>
</ul>
<h2 id="Wrapping-Up"><a href="#Wrapping-Up" class="headerlink" title="Wrapping Up"></a>Wrapping Up</h2><p>Deno’s not here to kill Node.js—it’s a different flavor of the same JavaScript pie. After messing with it for Supabase, I’m hooked on its simplicity and TypeScript support, but I’d still reach for Node.js on bigger, ecosystem-heavy projects. Try it yourself—spin up a Deno script, check your cache with <code>deno info</code>, and see if it clicks for you.</p>
<p>What’s your take? Node.js veteran or Deno newbie? Let me know in the comments!</p>
<hr>
<p>This post covers Deno’s core concepts, contrasts it with Node.js, and ties in our Supabase example for a practical angle. Feel free to tweak the tone or add more details if you’re aiming for a specific audience! Want me to adjust anything?</p>
</p>
      <div class="post-button"><a class="btn" href="/2025/03/28/Getting-Started-with-Deno-A-Modern-Twist-on-JavaScript-Runtimes/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2024/12/12/How-to-Generate-a-VSIX-File-from-VS-Code-Extension-Source-Code/">How to Generate a VSIX File from VS Code Extension Source Code</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2024-12-12</span>
      <p><p>As I’ve been using Windsurf as my primary code editor, I encountered a situation where the vs-picgo extension wasn’t available in the Windsurf marketplace. This necessitated the need to manually package the extension from its source code. This guide documents the process of generating a VSIX file for VS Code extensions, which can then be installed manually in compatible editors like Windsurf.</p>
<p>In this guide, I’ll walk you through the process of generating a VSIX file from a VS Code extension’s source code. We’ll use the popular <a target="_blank" rel="noopener" href="https://github.com/PicGo/vs-picgo">vs-picgo</a> extension as an example.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>Before we begin, make sure you have the following installed:</p>
<ul>
<li>Node.js (version 12 or higher)</li>
<li>npm (comes with Node.js)</li>
</ul>
<h2 id="Step-1-Install-Required-Tools"><a href="#Step-1-Install-Required-Tools" class="headerlink" title="Step 1: Install Required Tools"></a>Step 1: Install Required Tools</h2><p>First, we need to install two essential tools:</p>
<ul>
<li><code>yarn</code>: A package manager that will handle our dependencies</li>
<li><code>vsce</code>: The VS Code Extension Manager tool that creates VSIX packages</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Install Yarn globally</span></span><br><span class="line">sudo npm install -g yarn</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install vsce globally</span></span><br><span class="line">sudo npm install -g @vscode/vsce</span><br></pre></td></tr></table></figure>

<h2 id="Step-2-Prepare-the-Project"><a href="#Step-2-Prepare-the-Project" class="headerlink" title="Step 2: Prepare the Project"></a>Step 2: Prepare the Project</h2><ol>
<li><p>Clone or download the extension source code:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/PicGo/vs-picgo.git</span><br><span class="line"><span class="built_in">cd</span> vs-picgo</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install project dependencies:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn install</span><br></pre></td></tr></table></figure></li>
</ol>
<p>This command will:</p>
<ul>
<li>Read the <code>package.json</code> file</li>
<li>Install all required dependencies</li>
<li>Create or update the <code>yarn.lock</code> file</li>
</ul>
<blockquote>
<p><strong>Note</strong>: The <code>yarn.lock</code> file is important! Don’t delete it as it ensures consistent installations across different environments.</p>
</blockquote>
<h2 id="Step-3-Build-the-Extension"><a href="#Step-3-Build-the-Extension" class="headerlink" title="Step 3: Build the Extension"></a>Step 3: Build the Extension</h2><p>Build the extension using the production build command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn build:prod</span><br></pre></td></tr></table></figure>

<p>This command typically:</p>
<ul>
<li>Cleans the previous build output</li>
<li>Compiles TypeScript&#x2F;JavaScript files</li>
<li>Bundles all necessary assets</li>
<li>Creates the <code>dist</code> directory with the compiled code</li>
</ul>
<p>In vs-picgo’s case, the build process:</p>
<ol>
<li>Uses <code>esbuild</code> for fast bundling</li>
<li>Creates both extension and webview bundles</li>
<li>Generates source maps (disabled in production)</li>
<li>Optimizes the code for production use</li>
</ol>
<h2 id="Step-4-Package-the-Extension"><a href="#Step-4-Package-the-Extension" class="headerlink" title="Step 4: Package the Extension"></a>Step 4: Package the Extension</h2><p>Finally, create the VSIX file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vsce package</span><br></pre></td></tr></table></figure>

<p>This command:</p>
<ol>
<li>Runs any pre-publish scripts defined in <code>package.json</code></li>
<li>Validates the extension manifest</li>
<li>Packages all required files into a VSIX file</li>
<li>Names the file based on the extension’s name and version (e.g., <code>vs-picgo-2.1.6.vsix</code>)</li>
</ol>
<p>The resulting VSIX file will contain:</p>
<ul>
<li>Compiled JavaScript files</li>
<li>Assets (images, CSS, etc.)</li>
<li>Extension manifest</li>
<li>Documentation files</li>
<li>License information</li>
</ul>
<h2 id="What’s-Inside-the-VSIX"><a href="#What’s-Inside-the-VSIX" class="headerlink" title="What’s Inside the VSIX?"></a>What’s Inside the VSIX?</h2><p>The VSIX file is essentially a ZIP archive with a specific structure. For vs-picgo, it includes:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">vs-picgo-2.1.6.vsix</span><br><span class="line">├─ [Content_Types].xml </span><br><span class="line">├─ extension.vsixmanifest </span><br><span class="line">└─ extension/</span><br><span class="line">   ├─ LICENSE.txt</span><br><span class="line">   ├─ changelog.md</span><br><span class="line">   ├─ logo.png</span><br><span class="line">   ├─ package.json</span><br><span class="line">   ├─ package.nls.json</span><br><span class="line">   ├─ readme.md</span><br><span class="line">   └─ dist/</span><br><span class="line">      ├─ extension.js</span><br><span class="line">      └─ webview/</span><br><span class="line">         ├─ index.css</span><br><span class="line">         └─ index.js</span><br></pre></td></tr></table></figure>

<h2 id="Installing-the-Extension"><a href="#Installing-the-Extension" class="headerlink" title="Installing the Extension"></a>Installing the Extension</h2><p>You can install the generated VSIX file in VS Code or any compatible editor by:</p>
<ol>
<li>Opening VS Code&#x2F;Windsurf&#x2F;Cursor …</li>
<li>Going to the Extensions view</li>
<li>Clicking the “…” menu (More Actions)</li>
<li>Selecting “Install from VSIX…”</li>
<li>Choosing your generated VSIX file</li>
</ol>
<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><p>If you encounter any issues:</p>
<ol>
<li><p><strong>Missing dist directory error</strong>:</p>
<ul>
<li>This is normal on first build</li>
<li>The build process will create it automatically</li>
</ul>
</li>
<li><p><strong>Dependency errors</strong>:</p>
<ul>
<li>Run <code>yarn install</code> again</li>
<li>Check if you’re using the correct Node.js version</li>
</ul>
</li>
<li><p><strong>VSIX packaging fails</strong>:</p>
<ul>
<li>Verify your <code>package.json</code> is valid</li>
<li>Ensure all required files are present</li>
<li>Check the extension manifest for errors</li>
</ul>
</li>
</ol>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Building a VS Code extension VSIX file is straightforward once you have the right tools installed. The process mainly involves installing dependencies, building the source code, and packaging everything into a VSIX file.</p>
<p>Remember to keep your <code>yarn.lock</code> file and always build in production mode before packaging to ensure the best performance and smallest file size for your users.</p>
<p>Happy extension building! 🚀</p>
</p>
      <div class="post-button"><a class="btn" href="/2024/12/12/How-to-Generate-a-VSIX-File-from-VS-Code-Extension-Source-Code/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2024/11/14/What-is-DBOS-and-What-Should-We-Expect/">What is DBOS and What Should We Expect</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2024-11-14</span>
      <p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The computing world is witnessing a paradigm shift in how we think about operating systems. A team of researchers has proposed DBOS (Database-Oriented Operating System), a radical reimagining of operating system architecture that puts data management at its core. But what exactly is DBOS, and why should we care?</p>
<h2 id="What-is-DBOS"><a href="#What-is-DBOS" class="headerlink" title="What is DBOS?"></a>What is DBOS?</h2><p>DBOS is a novel operating system architecture that treats data management as its primary concern rather than traditional OS functions like process management and I&#x2F;O. The key insight behind DBOS is that modern applications are increasingly data-centric, yet our operating systems still follow designs from the 1970s that prioritize computation over data management.</p>
<p>Instead of treating databases as just another application, DBOS makes database technology the fundamental building block of the operating system itself. This means core OS functions like process scheduling, resource management, and system monitoring are implemented using database principles and technologies.</p>
<h2 id="Who-is-behind-DBOS"><a href="#Who-is-behind-DBOS" class="headerlink" title="Who is behind DBOS?"></a>Who is behind DBOS?</h2><p>DBOS is a collaborative research project involving almost twenty researchers across multiple institutions including MIT, Stanford, UW-Madison, Google, VMware, and other organizations. The project is notably led by database pioneer Michael Stonebraker, who is an ACM Turing Award winner (2014) and Professor Emeritus at UC Berkeley, currently affiliated with MIT.</p>
<p>Key institutions and researchers involved include:</p>
<ul>
<li>MIT: Michael Stonebraker, Michael Cafarella, Çağatay Demiralp, and others</li>
<li>Stanford: Matei Zaharia, Christos Kozyrakis, and others</li>
<li>UW-Madison: Xiangyao Yu</li>
<li>Industry partners: Researchers from Google, VMware, and other organizations</li>
</ul>
<p>The people behind DBOS can be found at <a target="_blank" rel="noopener" href="https://dbos-project.github.io/">DBOS Project</a>.</p>
<h2 id="Ultimate-Goal"><a href="#Ultimate-Goal" class="headerlink" title="Ultimate Goal"></a>Ultimate Goal</h2><p>The ultimate goal of DBOS is to create an operating system that is data-centric and data-driven, the OS is on top of a DBMS, not like today’s DBMS on top of the OS.<br>ALL system data should reside in the DBMS.</p>
<ul>
<li>Replace the “everything is a file” mantra with “everything is a table”</li>
<li>All system state and metadata stored in relational tables</li>
<li>All changes to OS state should be through database transactions</li>
<li>DBMS provides All functions that a DBMS can do, for example, files are blobs and tables in the DBMS.</li>
<li>SQL-based interface for both application and system data access</li>
<li>To achieve very high performance, the DBMS must leverage sophisticated caching and parallelization strategies and compile repetitive queries into machine code.</li>
</ul>
<h2 id="Benefits"><a href="#Benefits" class="headerlink" title="Benefits"></a>Benefits</h2><ol>
<li>Strong Security and Privacy</li>
</ol>
<ul>
<li>Native GDPR compliance through data-centric design</li>
<li>Attribute-based access control (ABAC)</li>
<li>Complete audit trails and data lineage</li>
<li>Privacy by design through unified data management</li>
<li>Fine-grained access control at the data level</li>
<li>Enhanced monitoring and threat detection</li>
<li>Simplified compliance with regulatory requirements</li>
<li>Built-in data encryption and protection mechanisms</li>
</ul>
<ol start="2">
<li>Enhanced Performance and Efficiency</li>
</ol>
<ul>
<li>Optimized resource allocation through database-driven scheduling</li>
<li>Reduced data movement and copying</li>
<li>Better cache utilization through database techniques</li>
<li>Intelligent workload management</li>
<li>Advanced query optimization for system operations</li>
<li>Improved resource utilization through data-aware decisions</li>
<li>Reduced system overhead through unified architecture</li>
<li>Better support for modern hardware architectures</li>
</ul>
<ol start="3">
<li>Improved Observability and Management</li>
</ol>
<ul>
<li>Comprehensive system-wide monitoring</li>
<li>Real-time analytics on system performance</li>
<li>Easy troubleshooting through SQL queries</li>
<li>Better capacity planning capabilities</li>
<li>Unified logging and debugging interface</li>
<li>Historical analysis of system behavior</li>
<li>Predictive maintenance capabilities</li>
<li>Simplified system administration</li>
</ul>
<ol start="4">
<li>Advanced Application Support</li>
</ol>
<ul>
<li>Native support for distributed applications</li>
<li>Better handling of microservices architecture</li>
<li>Simplified state management</li>
<li>Enhanced support for modern cloud applications</li>
<li>Built-in support for data-intensive applications</li>
<li>Improved consistency guarantees</li>
<li>Better transaction management</li>
<li>Simplified development of distributed systems</li>
</ul>
<h2 id="Technical-Implementation"><a href="#Technical-Implementation" class="headerlink" title="Technical Implementation"></a>Technical Implementation</h2><p>DBOS proposes implementing core OS functions using database principles:</p>
<ul>
<li>Process Management: Processes and their states managed as database tables</li>
<li>Resource Scheduling: SQL queries and ML for intelligent scheduling decisions</li>
<li>System Monitoring: Metrics collection and analysis through database queries</li>
<li>Security: Access control and auditing via database mechanisms</li>
<li>Storage: File system metadata stored in relational tables</li>
<li>Networking: Network state and routing managed through database abstractions</li>
</ul>
<h2 id="What-Should-We-Expect"><a href="#What-Should-We-Expect" class="headerlink" title="What Should We Expect?"></a>What Should We Expect?</h2><h3 id="Near-term-Impact"><a href="#Near-term-Impact" class="headerlink" title="Near-term Impact"></a>Near-term Impact</h3><ul>
<li>Proof of Concept: The researchers are working on demonstrating DBOS’s capabilities through specific use cases like log processing and accelerator management.</li>
<li>Performance Improvements: Early implementations might show significant improvements in data-intensive workloads.</li>
<li>Development Tools: New tools and frameworks that leverage DBOS’s database-centric approach.</li>
</ul>
<h3 id="Long-term-Possibilities"><a href="#Long-term-Possibilities" class="headerlink" title="Long-term Possibilities"></a>Long-term Possibilities</h3><p>Cloud Native Integration: DBOS could become particularly relevant for cloud computing environments where data management is crucial.</p>
<ul>
<li>AI&#x2F;ML Operations: Better support for AI and machine learning workloads through intelligent resource management.</li>
<li>Privacy-First Computing: A new standard for building privacy-compliant systems from the ground up.</li>
</ul>
<h3 id="Challenges-Ahead"><a href="#Challenges-Ahead" class="headerlink" title="Challenges Ahead"></a>Challenges Ahead</h3><p>Several technical and practical challenges need to be addressed:</p>
<ol>
<li>Performance</li>
</ol>
<ul>
<li>Minimizing database overhead for system operations</li>
<li>Optimizing query performance for real-time OS operations</li>
<li>Efficient handling of high-frequency system events</li>
</ul>
<ol start="2">
<li>Compatibility</li>
</ol>
<ul>
<li>Supporting existing applications and system calls</li>
<li>Maintaining POSIX compliance where needed</li>
<li>Migration path for legacy systems</li>
</ul>
<ol start="3">
<li>Distributed Systems</li>
</ol>
<ul>
<li>Maintaining consistency across distributed nodes</li>
<li>Handling network partitions and failures</li>
<li>Scaling database operations across clusters</li>
</ul>
<ol start="4">
<li>Adoption</li>
</ol>
<ul>
<li>Convincing stakeholders to adopt radical architectural changes</li>
<li>Training developers in the new paradigm</li>
<li>Building an ecosystem of compatible tools and applications</li>
</ul>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>DBOS represents a bold reimagining of operating system design for the data-centric world. While it’s still in its early stages, the potential benefits for security, privacy, and developer productivity make it an exciting project to watch. As data continues to grow in importance, DBOS’s approach might prove to be prescient.<br>The success of DBOS will largely depend on how well it can demonstrate its advantages in real-world scenarios and whether it can overcome the inherent challenges of introducing such a fundamental change to system architecture. For developers, system administrators, and anyone interested in the future of computing, DBOS is definitely worth keeping an eye on.<br>Whether DBOS becomes the next evolution in operating systems or remains an interesting academic exercise, its ideas about putting data management at the center of system design will likely influence future OS development.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><p>M. Stonebraker et al., “DBOS: A DBMS-oriented Operating System,” <em>Proceedings of the VLDB Endowment</em>, Vol. 15, No. 1, 2021.<br><a target="_blank" rel="noopener" href="https://www.vldb.org/pvldb/vol15/p21-stonebraker.pdf">https://www.vldb.org/pvldb/vol15/p21-stonebraker.pdf</a></p>
</li>
<li><p>DBOS Project Official Website, MIT CSAIL and Stanford University.<br><a target="_blank" rel="noopener" href="https://dbos-project.github.io/">https://dbos-project.github.io/</a></p>
</li>
<li><p>X. Yu et al., “A Case for Building Operating Systems with Database Technology,” <em>Proceedings of the 12th Conference on Innovative Data Systems Research (CIDR ‘22)</em>, 2022.<br><a target="_blank" rel="noopener" href="https://www.cidrdb.org/cidr2022/papers/p82-yu.pdf">https://www.cidrdb.org/cidr2022/papers/p82-yu.pdf</a></p>
</li>
<li><p>DBOS Research Group Publications.<br><a target="_blank" rel="noopener" href="https://dbos-project.github.io/papers/">https://dbos-project.github.io/papers/</a></p>
</li>
</ol>
<p>These references provide detailed technical information about DBOS’s architecture, implementation, and potential impact on the future of operating systems. The papers discuss various aspects from system design to performance evaluation, security considerations, and practical applications.</p>
</p>
      <div class="post-button"><a class="btn" href="/2024/11/14/What-is-DBOS-and-What-Should-We-Expect/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2024/10/05/The%20best%20practices%20for%20using%20partition%20table%20in%20PostgreSQL/"></a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2024-10-05</span>
      <p><h1 id="The-best-practices-for-using-partition-table-in-PostgreSQL"><a href="#The-best-practices-for-using-partition-table-in-PostgreSQL" class="headerlink" title="The best practices for using partition table in PostgreSQL"></a>The best practices for using partition table in PostgreSQL</h1><h2 id="What-is-partition-table"><a href="#What-is-partition-table" class="headerlink" title="What is partition table?"></a>What is partition table?</h2><p>Partition table is a table that is divided into smaller parts. Each part is called a partition.</p>
<p>Why use partition table?</p>
<ol>
<li><strong>Performance</strong>: Partition table can improve the performance of the table. Because each partition can be stored in a separate file, the query can be executed faster.</li>
<li><strong>Maintenance</strong>: Partition table can make the maintenance of the table easier. Because each partition can be maintained separately, the maintenance of the table can be done faster.</li>
</ol>
<h2 id="How-to-create-a-partition-table"><a href="#How-to-create-a-partition-table" class="headerlink" title="How to create a partition table?"></a>How to create a partition table?</h2><ol>
<li><strong>Create a partition table</strong>:</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> measurement (</span><br><span class="line">    city_id         <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    logdate         <span class="type">date</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    peaktemp        <span class="type">int</span>,</span><br><span class="line">    unitsales       <span class="type">int</span></span><br><span class="line">) <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span> (logdate);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>Create a partition table for each partition</strong>:</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> measurement_y2006m02 <span class="keyword">PARTITION</span> <span class="keyword">OF</span> measurement</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">VALUES</span> <span class="keyword">FROM</span> (<span class="string">&#x27;2006-02-01&#x27;</span>) <span class="keyword">TO</span> (<span class="string">&#x27;2006-03-01&#x27;</span>);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> measurement_y2007m11 <span class="keyword">PARTITION</span> <span class="keyword">OF</span> measurement</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">VALUES</span> <span class="keyword">FROM</span> (<span class="string">&#x27;2007-11-01&#x27;</span>) <span class="keyword">TO</span> (<span class="string">&#x27;2007-12-01&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Partition-table-types"><a href="#Partition-table-types" class="headerlink" title="Partition table types"></a>Partition table types</h2><p>There are 3 basic types of partition table in PostgreSQL:</p>
<ol>
<li><strong>List Partition</strong>: The table is partitioned by explicitly listing which key value(s) appear in each partition.</li>
<li><strong>Range Partition</strong>: The table is partitioned into “ranges” defined by a key column or set of columns, with no overlap between the ranges of values assigned to different partitions.</li>
<li><strong>Hash Partition</strong>: The table is partitioned by specifying a modulus and a remainder for each partition.</li>
</ol>
<p>Combine these 3 basic types of partition table, we can create more complex partition table. This is called <strong>Composite Partitioning</strong>.</p>
<p>There are 4 types of composite partitioning:</p>
<ol>
<li><strong>List-Range Partition</strong>: The partition is divided into several ranges.<br>The step is: create table A partition by list, then create table A1 partition of A partition by range, then create table A1-1 partition of A1</li>
<li><strong>Range-List Partition</strong>: The partition is divided into several ranges.<br>The step is: create table A partition by range, then create table B of table A but partition by list.</li>
<li><strong>Range-Hash Partition</strong>: The partition is divided into several ranges.</li>
<li><strong>Hash-Range Partition</strong>: The partition is divided into several ranges.</li>
</ol>
<h2 id="Data-dictionary-about-partition-table"><a href="#Data-dictionary-about-partition-table" class="headerlink" title="Data dictionary about partition table"></a>Data dictionary about partition table</h2><ol>
<li><strong>pg_partitioned_table</strong>: This table stores the information about the partitioned table.</li>
<li><strong>pg_partition_rule</strong>: This table stores the information about the partition rule.</li>
<li><strong>pg_partition_column</strong>: This table stores the information about the partition column.</li>
<li><strong>pg_partition_index</strong>: This table stores the information about the partition index.</li>
<li><strong>pg_partition_constraint</strong>: This table stores the information about the partition constraint.</li>
<li><strong>pg_partition_constraint_column</strong>: This table stores the information about the partition constraint column.</li>
<li><strong>pg_partition_constraint_index</strong>: This table stores the information about the partition constraint index.</li>
</ol>
</p>
      <div class="post-button"><a class="btn" href="/2024/10/05/The%20best%20practices%20for%20using%20partition%20table%20in%20PostgreSQL/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2024/08/21/Some-Misconceptions-About-Database-Performance-Application-Concurrent-Requests-Database-Connections-and-Database-Connection-Pools/">Some Misconceptions About Database Performance - Application Concurrent Requests, Database Connections, and Database Connection Pools</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2024-08-21</span>
      <p><p>Let’s start with a chart from a database stress test result.</p>
<p><img src="https://s2.loli.net/2024/08/21/Ra2u1Q9cJNpOlUm.png" alt="1724216413686"></p>
<p>In the chart above, the X-axis represents the number of concurrent connections, and the Y-axis represents the TPS (Transactions Per Second) provided by the database. The stress testing tool used is pgbench, and the database is a single instance of PostgreSQL 16. TPS_PGDirect represents the TPS when pgbench directly sends the load to PostgreSQL, while TPS_PGBouncer represents the TPS when pgbench sends the load to the PGBouncer database connection pool.</p>
<p>We can clearly see that when the number of connections exceeds 256, the TPS begins to gradually decline when the load is sent directly to the database. When the number of connections eventually rises to over 8000, the database is almost at a standstill. However, when using PGBouncer, the TPS remains stable and excellent, with the database consistently providing high TPS regardless of the number of connections.</p>
<p>Many people might conclude from this chart that if the concurrent connections increase beyond a certain threshold, PostgreSQL becomes inadequate, and PGBouncer must be used to improve performance.</p>
<p>Some users may attempt to conduct various hardware environment combination tests to derive a reference threshold number to guide at what pressure PostgreSQL can cope, and once it exceeds a certain pressure, PGBouncer should be enabled.</p>
<p>So, is this conclusion correct? And does testing out a threshold number have real guiding significance?</p>
<h2 id="Understanding-Concurrent-Performance"><a href="#Understanding-Concurrent-Performance" class="headerlink" title="Understanding Concurrent Performance"></a>Understanding Concurrent Performance</h2><p>To determine how many concurrent business requests a database can handle, we should focus on the Y-axis from the test chart above, rather than the X-axis. The Y-axis TPS represents the number of transactions the database can process per second, while the X-axis connection count is merely the database connection number we configured ourselves (which can be simply understood as the max_connections parameter value). We can observe that at 256 connections, the direct database stress test with pgbench allows the database to provide over 50,000 TPS, which is actually almost the highest number in the entire stress test (WITHOUT PGBouncer). Subsequent tests using PGBouncer, this number was not significantly exceeded. Therefore, PGBouncer is not a weapon to improve database performance.</p>
<p>What is performance? Performance means: for a determined business transaction pressure (how much work a business transaction needs to handle, such as how much CPU, memory, and IO it consumes), the more transactions the database can execute, the higher the performance. In the chart above, this is represented by the Y-axis TPS (Transactions Per Second).</p>
<p>For example, suppose a user request (Application Request) requires executing 5 transactions from start to finish, and assume these transactions consume similar amounts of time (even if there are differences, we can always get the average transaction runtime in a system). In this case, 50,000 TPS means the database can handle 10,000 user requests per second, which can be simply understood as handling 10,000 concurrent users. If TPS rises to 100,000, the database can handle 20,000 concurrent users; if TPS drops to 10,000, it can only handle 2,000 concurrent users. This is a simple calculation logic, and in this description, we did not mention anything about database connections (User Connections).</p>
<p>So why does it seem like PGBouncer improves performance when the number of connections continues to increase? Because in this situation, PGBouncer acts as a limiter on database connections, reducing the extra overhead caused by the database&#x2F;operating system handling too many connections, allowing the database and operating system to focus on processing the business requests sent from each connection, and enabling user requests exceeding the connection limit to share database connections. What PGBouncer does is: if your restaurant can only provide 10 tables, then I only allow 10 tables of guests to enter, and other guests have to wait outside.</p>
<p>However, why should we let 100 tables of guests rush into the restaurant all at once? Without PGBouncer, can’t we control allowing only 10 tables of guests to enter? In modern applications, application-side connection pools are more commonly used, such as connection pools in various middleware software (Weblogic, WebSphere, Tomcat, etc.) or dedicated JDBC connection pools like HikariCP.</p>
<p>Exceeding the number of connections that can be handled is unnecessary. When the database is already at its peak processing capacity, having more connections will not improve overall processing capability; instead, it will slow down the entire database.</p>
<p>To summarize the meaning of the chart above more straightforwardly: when the total number of database connections is at 256, the database reaches its peak processing capacity, and direct database connections can provide 50,000 TPS without any connection pool. If 50,000 TPS cannot meet the application’s concurrent performance requirements, increasing the number of connections will not help. But if connections are increased (wrongly, without any other control), a layer of connection pool like PGBouncer can be added as a connection pool buffer to keep performance stable at around 50,000 TPS.</p>
<p>So, do we have any reason to arbitrarily increase the number of connections? No. What we need to do is: allow the database to open only the number of connections within its processing capacity and enable these connections to be shared by more user requests. When the restaurant size is fixed, the higher the turnover rate, the higher the restaurant’s daily revenue.</p>
<h2 id="How-to-Ask-Questions-About-Performance"><a href="#How-to-Ask-Questions-About-Performance" class="headerlink" title="How to Ask Questions About Performance"></a>How to Ask Questions About Performance</h2><p>Instead of asking: how can we ensure the database provides sufficient TPS with 4000 connections, we should ask: how can we ensure the database provides 50,000 TPS.</p>
<p>Because the number of connections is not a performance metric, it is merely a parameter configuration option.</p>
<p>In the example above, a connection count of 4000 or 8000 is not a fixed value, nor is it an optimized value. We cannot try to do more additional database optimizations on an unoptimized, modifiable parameter setting, as this may lead to a reversal of priorities. If we can already provide maximum processing capacity with 256 fully loaded database connections, why optimize a database with more than 256 connections? We should ensure the database always runs at full capacity with a maximum of 256 connections.</p>
<p>Now, our question about performance can be more specific. Suppose we have multiple sets of database servers with different configurations; what should the fully loaded connection count be for each set to achieve optimal processing capacity?</p>
<p>This requires testing. However, we will ultimately find that this fully loaded connection count is usually related only to the database server’s hardware resources, such as the number of CPU cores, CPU speed, memory size, storage speed, and the bandwidth and latency between storage and host.</p>
<h2 id="Is-Database-Application-Performance-Only-Related-to-Hardware-Resources"><a href="#Is-Database-Application-Performance-Only-Related-to-Hardware-Resources" class="headerlink" title="Is Database Application Performance Only Related to Hardware Resources?"></a>Is Database Application Performance Only Related to Hardware Resources?</h2><p>Of course not. Concurrent performance (P) &#x3D; Hardware processing capability (H) &#x2F; Business transaction pressure (T).</p>
<p>As mentioned earlier, the performance metric TPS is for a “determined business transaction pressure,” meaning a determined T value.</p>
<p>When the T value is determined, we can only improve the H value to further enhance the P value. Conversely, there is naturally another optimization approach: reducing the T value. There are various ways to reduce the T value, such as adding necessary indexes, rewriting SQL, using partitioned tables, etc. The optimization plan should be formulated based on where the T value is consumed most, which is another topic.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>To answer the two initial questions:</p>
<ol>
<li>If concurrent connections increase beyond a certain threshold, PostgreSQL becomes inadequate, and PGBouncer must be used to improve performance. Is this conclusion correct?</li>
</ol>
<p>If we must create more connections to the database than the hardware processing capacity for certain hardware resources, using PGBouncer can stabilize performance. However, we have no reason to create more connections than the hardware processing capacity. We have various means to control the maximum number of connections the database can open, and various middleware solutions can provide connection pools. From this perspective, PGBouncer does not improve database performance; it merely reduces concurrency conflicts, doing what any connection pool software can do.</p>
<ol start="2">
<li>Is it meaningful to attempt various hardware environment combination tests to derive a reference threshold number to guide at what pressure PostgreSQL can cope, and once it exceeds a certain pressure, PGBouncer should be enabled?</li>
</ol>
<p>It has some significance, but simple stress tests like pgbench are not enough to guide real applications. Concurrent performance (P) &#x3D; Hardware processing capability (H) &#x2F; Business transaction pressure (T). Testing in a determined hardware environment means the H value is fixed, so we should focus on T during testing. The T value provided by pgbench is a very simple transaction pressure (only four tables, simple CRUD operations), and the P value tested under this pressure can only be used as a reference. To guide application deployment, typical transaction pressure of the application itself must be abstracted for testing to have guiding significance.</p>
</p>
      <div class="post-button"><a class="btn" href="/2024/08/21/Some-Misconceptions-About-Database-Performance-Application-Concurrent-Requests-Database-Connections-and-Database-Connection-Pools/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2024/06/15/Flashback-Features-in-MogDB/">Flashback Features in MogDB</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2024-06-15</span>
      <p><h2 id="What-is-Database-Flashback"><a href="#What-is-Database-Flashback" class="headerlink" title="What is Database Flashback"></a>What is Database Flashback</h2><p>The flashback capability of a database allows users to query the contents of a table at a specific point in the past or quickly restore a table or even the entire database to a time before an erroneous operation. This feature can be extremely useful, and sometimes even a lifesaver.</p>
<p>Database flashback capabilities are generally divided into three levels:</p>
<ul>
<li><strong>Row-level Flashback:</strong> Also known as flashback query, this typically involves using a SELECT statement to retrieve data from a table as it was at a specific point in time, such as right before a DELETE command was issued.</li>
<li><strong>Table-level Flashback:</strong> Also known as flashback table, this usually involves using specialized DDL statements to recreate a table from the recycle bin. This is often used to recover from a TRUNCATE TABLE or DROP TABLE operation.</li>
<li><strong>Database-level Flashback:</strong> Also known as flashback database, this involves using specialized DDL statements to restore the entire database to a previous point in time. Unlike PITR (Point-In-Time Recovery) which involves restoring from backups, flashback database is faster as it does not require restoring the entire database from backup sets.</li>
</ul>
<p>In MogDB version 5.0, only flashback query and flashback table have been implemented so far. Flashback database has not yet been implemented (Oracle has supported flashback database since version 10g).</p>
<h2 id="Scenario"><a href="#Scenario" class="headerlink" title="Scenario"></a>Scenario</h2><p>Imagine a regrettable scenario (<strong>Note:</strong> do not run the DELETE SQL command in a production environment).</p>
<p>You have a table that records account names and account balances.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> A    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> B    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> C    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line">(<span class="number">4</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>

<p>You intended to execute an SQL command to delete account records with a balance of 99 units. Normally, this should delete one record. To demonstrate, let’s use SELECT instead of DELETE.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts <span class="keyword">where</span> amount<span class="operator">=</span><span class="number">99</span>;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line">(<span class="number">1</span> <span class="type">row</span>)</span><br></pre></td></tr></table></figure>

<p>However, the minus sign “-“ and the equals sign “&#x3D;” are adjacent on the keyboard, and you have fat fingers, so you accidentally pressed the minus sign. As a result, the command you sent to the database looks like this:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> accounts <span class="keyword">where</span> amount<span class="number">-99</span>;</span><br></pre></td></tr></table></figure>

<p>For demonstration purposes, we’ll still use SELECT instead of DELETE.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts <span class="keyword">where</span> amount<span class="number">-99</span>;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> A    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> B    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> C    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line">(<span class="number">3</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>

<p>A terrifying thing happens: all data except the record with a balance exactly equal to 99 is returned. This means that if this were the DELETE command mentioned above, you would have deleted all accounts with a balance not equal to 99.</p>
<p>The good news is that starting from MogDB version 3.0, validation for such dangerous syntax involving the minus sign has been added. Now, executing the same SQL will result in an error.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">delete</span> <span class="keyword">from</span> accounts <span class="keyword">where</span> amount<span class="number">-99</span>;</span><br><span class="line">ERROR:  argument <span class="keyword">of</span> <span class="keyword">WHERE</span> must be type <span class="type">boolean</span>, <span class="keyword">not</span> type <span class="type">integer</span></span><br><span class="line">LINE <span class="number">1</span>: <span class="keyword">delete</span> <span class="keyword">from</span> accounts <span class="keyword">where</span> amount<span class="number">-99</span>;</span><br><span class="line">                                   <span class="operator">^</span></span><br></pre></td></tr></table></figure>

<p>However, in the community editions of openGauss, MySQL, or MariaDB, such dangerous syntax can still be executed normally.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">gsql ((openGauss <span class="number">6.0</span><span class="number">.0</span><span class="operator">-</span>RC1 build ed7f8e37) compiled <span class="keyword">at</span> <span class="number">2024</span><span class="number">-03</span><span class="number">-31</span> <span class="number">12</span>:<span class="number">41</span>:<span class="number">30</span> <span class="keyword">commit</span> <span class="number">0</span> <span class="keyword">last</span> mr  )</span><br><span class="line">Non<span class="operator">-</span>SSL connection (SSL connection <span class="keyword">is</span> recommended <span class="keyword">when</span> requiring high<span class="operator">-</span>security)</span><br><span class="line">Type &quot;help&quot; <span class="keyword">for</span> help.</span><br><span class="line"></span><br><span class="line">openGauss<span class="operator">=</span># <span class="keyword">select</span> version();</span><br><span class="line">                                                                          version</span><br><span class="line"><span class="comment">------------------------------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"> (openGauss <span class="number">6.0</span><span class="number">.0</span><span class="operator">-</span>RC1 build ed7f8e37) compiled <span class="keyword">at</span> <span class="number">2024</span><span class="number">-03</span><span class="number">-31</span> <span class="number">12</span>:<span class="number">41</span>:<span class="number">30</span> <span class="keyword">commit</span> <span class="number">0</span> <span class="keyword">last</span> mr   <span class="keyword">on</span> aarch64<span class="operator">-</span><span class="literal">unknown</span><span class="operator">-</span>linux<span class="operator">-</span>gnu, compiled <span class="keyword">by</span> g<span class="operator">+</span><span class="operator">+</span> (GCC) <span class="number">10.3</span><span class="number">.1</span>, <span class="number">64</span><span class="operator">-</span>bit</span><br><span class="line">(<span class="number">1</span> <span class="type">row</span>)</span><br><span class="line"></span><br><span class="line">openGauss<span class="operator">=</span># <span class="keyword">create</span> <span class="keyword">table</span> accounts (name varchar2, amount <span class="type">int</span>);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span></span><br><span class="line">openGauss<span class="operator">=</span># <span class="keyword">insert</span> <span class="keyword">into</span> accounts <span class="keyword">values</span> (<span class="string">&#x27;A&#x27;</span>,<span class="number">100</span>),(<span class="string">&#x27;B&#x27;</span>,<span class="number">100</span>),(<span class="string">&#x27;C&#x27;</span>,<span class="number">100</span>),(<span class="string">&#x27;D&#x27;</span>,<span class="number">99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="number">0</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line">openGauss<span class="operator">=</span># <span class="keyword">delete</span> <span class="keyword">from</span> accounts <span class="keyword">where</span> amount<span class="number">-99</span>;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="number">3</span></span><br><span class="line">openGauss<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line">(<span class="number">1</span> <span class="type">row</span>)</span><br></pre></td></tr></table></figure>

<p>No matter what kind of erroneous operation occurs, suppose a data deletion error really happens. In MogDB, you still have the flashback feature available for recovery.</p>
<h2 id="Flashback-Feature-in-MogDB"><a href="#Flashback-Feature-in-MogDB" class="headerlink" title="Flashback Feature in MogDB"></a>Flashback Feature in MogDB</h2><p>The flashback feature and its related implementations have undergone some changes since MogDB version 3.0.</p>
<ol>
<li><p><strong>Applicable Only to Ustore Storage Engine:</strong></p>
<p>The flashback feature only works for tables using the ustore storage engine. The default astore no longer supports flashback queries. Therefore, you need to set <code>enable_ustore=on</code>. This parameter is off by default, and changing it requires a database restart to take effect.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">set</span> enable_ustore<span class="operator">=</span><span class="keyword">on</span>;</span><br><span class="line">NOTICE:  please restart the database <span class="keyword">for</span> the POSTMASTER level <span class="keyword">parameter</span> <span class="keyword">to</span> take effect.</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Setting <code>undo_retention_time</code>:</strong></p>
<p>This parameter specifies the retention time for old version data in the rollback segment, equivalent to the allowable time span for flashback queries. The default value is 0, meaning any flashback query will encounter a “restore point not found” error. Changing this parameter does not require a database restart.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">set</span> undo_retention_time<span class="operator">=</span><span class="number">86400</span>; <span class="comment">-- 86400 seconds = 24 hours</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Enabling Database Recycle Bin for Truncate or Drop Operations:</strong></p>
<p>To flashback a table from a truncate or drop operation, you need to enable the database recycle bin by setting <code>enable_recyclebin=on</code>. This parameter is off by default, and changing it does not require a database restart.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">set</span> enable_recyclebin<span class="operator">=</span><span class="keyword">on</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Creating-and-Populating-the-Ustore-Table"><a href="#Creating-and-Populating-the-Ustore-Table" class="headerlink" title="Creating and Populating the Ustore Table"></a>Creating and Populating the Ustore Table</h3><p>Create a ustore-based <code>accounts</code> table and insert some test data.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">create</span> <span class="keyword">table</span> accounts (name varchar2, amount <span class="type">int</span>) <span class="keyword">with</span> (storage_type<span class="operator">=</span>ustore);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">insert</span> <span class="keyword">into</span> accounts <span class="keyword">values</span> (<span class="string">&#x27;A&#x27;</span>,<span class="number">100</span>),(<span class="string">&#x27;B&#x27;</span>,<span class="number">100</span>),(<span class="string">&#x27;C&#x27;</span>,<span class="number">100</span>),(<span class="string">&#x27;D&#x27;</span>,<span class="number">99</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="number">0</span> <span class="number">4</span></span><br></pre></td></tr></table></figure>

<h3 id="Simulating-an-Erroneous-Deletion"><a href="#Simulating-an-Erroneous-Deletion" class="headerlink" title="Simulating an Erroneous Deletion"></a>Simulating an Erroneous Deletion</h3><p>Now, due to some erroneous operation, you delete all account records with amounts not equal to 99.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">delete</span> <span class="keyword">from</span> accounts <span class="keyword">where</span> amount<span class="operator">&lt;&gt;</span><span class="number">99</span>;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line">(<span class="number">1</span> <span class="type">row</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Flashback-Query"><a href="#Flashback-Query" class="headerlink" title="Flashback Query"></a>Flashback Query</h3><p>When you realize the mistake, it might be 1 minute or 1 hour later. As long as it is within 24 hours (due to the <code>undo_retention_time</code> setting), you can recover the data.</p>
<p>Check the current timestamp and estimate the timestamp at the time of the erroneous operation. For simplicity, let’s assume you noted the system’s timestamp before issuing the delete command.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> sysdate;</span><br><span class="line">       sysdate</span><br><span class="line"><span class="comment">---------------------</span></span><br><span class="line"> <span class="number">2024</span><span class="number">-06</span><span class="number">-13</span> <span class="number">18</span>:<span class="number">40</span>:<span class="number">18</span></span><br><span class="line">(<span class="number">1</span> <span class="type">row</span>)</span><br></pre></td></tr></table></figure>

<p>Issue a flashback query to retrieve the data as it was at the specified timestamp.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts timecapsule <span class="type">TIMESTAMP</span> to_timestamp(<span class="string">&#x27;2024-06-13 18:40:18&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span>);</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> A    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> B    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> C    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line">(<span class="number">4</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Recovering-Data"><a href="#Recovering-Data" class="headerlink" title="Recovering Data"></a>Recovering Data</h3><p>You can recover the data by creating a temporary table with the flashback query results and then inserting the data back into the original table.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">create</span> <span class="keyword">table</span> tmp_accounts <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts timecapsule <span class="type">TIMESTAMP</span> to_timestamp(<span class="string">&#x27;2024-06-13 18:40:18&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span>) <span class="keyword">where</span> amount<span class="operator">&lt;&gt;</span><span class="number">99</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="number">0</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tmp_accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> A    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> B    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> C    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line">(<span class="number">3</span> <span class="keyword">rows</span>)</span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">insert</span> <span class="keyword">into</span> accounts <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tmp_accounts;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="number">0</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line"> A    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> B    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> C    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line">(<span class="number">4</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>

<p>Alternatively, if no new data has been added to the table after the erroneous operation, you can use the <code>timecapsule table</code> command to flashback the entire table to the specified timestamp.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># timecapsule <span class="keyword">table</span> accounts <span class="keyword">to</span> <span class="type">TIMESTAMP</span> to_timestamp(<span class="string">&#x27;2024-06-13 18:40:18&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span>);</span><br><span class="line">TimeCapsule <span class="keyword">Table</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line"> A    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> B    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> C    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line">(<span class="number">4</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Recovering-from-Truncate-or-Drop-Table"><a href="#Recovering-from-Truncate-or-Drop-Table" class="headerlink" title="Recovering from Truncate or Drop Table"></a>Recovering from Truncate or Drop Table</h3><p>If you accidentally issue a <code>TRUNCATE</code> or <code>DROP</code> command, In this situation, the before commands don’t help because the data has been truncated.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">truncate</span> <span class="keyword">table</span> accounts;</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts timecapsule <span class="type">TIMESTAMP</span> to_timestamp(<span class="string">&#x27;2024-06-14 02:10:28&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span>);</span><br><span class="line">ERROR:  Snapshot too <span class="keyword">old</span>, ScanRelation, the info: snapxmax <span class="keyword">is</span> <span class="number">45865</span>, snapxmin <span class="keyword">is</span> <span class="number">45865</span>, csn <span class="keyword">is</span> <span class="number">30047</span>, relfrozenxid64 <span class="keyword">is</span> <span class="number">45877</span>, globalRecycleXid <span class="keyword">is</span> <span class="number">17356.</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># timecapsule <span class="keyword">table</span> accounts <span class="keyword">to</span> <span class="type">TIMESTAMP</span> to_timestamp(<span class="string">&#x27;2024-06-14 02:10:28&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span>);</span><br><span class="line">TimeCapsule <span class="keyword">Table</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line">(<span class="number">0</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>

<p>For <code>TRUNCATE</code> or <code>DROP TABLE</code> operations, use the <code>to before</code> keyword to recover the table from the recycle bin.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># timecapsule <span class="keyword">table</span> accounts <span class="keyword">to</span> before <span class="keyword">truncate</span>;</span><br><span class="line">TimeCapsule <span class="keyword">Table</span></span><br><span class="line"></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> A    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> B    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> C    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line">(<span class="number">4</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>

<p>Similarly, if the table was dropped, you can recover it from the recycle bin using the same <code>to before</code> keyword.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MogDB<span class="operator">=</span># <span class="keyword">drop</span> <span class="keyword">table</span> accounts;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line">ERROR:  relation &quot;accounts&quot; does <span class="keyword">not</span> exist <span class="keyword">on</span> dn_6001</span><br><span class="line">LINE <span class="number">1</span>: <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line">                      <span class="operator">^</span></span><br><span class="line">MogDB<span class="operator">=</span># timecapsule <span class="keyword">table</span> accounts <span class="keyword">to</span> before <span class="keyword">drop</span>;</span><br><span class="line">TimeCapsule <span class="keyword">Table</span></span><br><span class="line">MogDB<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> accounts;</span><br><span class="line"> name <span class="operator">|</span> amount</span><br><span class="line"><span class="comment">------+--------</span></span><br><span class="line"> A    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> B    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> C    <span class="operator">|</span>    <span class="number">100</span></span><br><span class="line"> D    <span class="operator">|</span>     <span class="number">99</span></span><br><span class="line">(<span class="number">4</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>



<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>MogDB’s flashback feature is an essential tool for recovering from accidental data deletions, truncations, or drops. By enabling the ustore storage engine, setting an appropriate <code>undo_retention_time</code>, and activating the recycle bin, you can leverage flashback queries and the <code>timecapsule</code> command to restore your data efficiently. These features ensure that you can maintain data integrity and quickly recover from human errors, providing robust data protection and operational resilience.</p>
</p>
      <div class="post-button"><a class="btn" href="/2024/06/15/Flashback-Features-in-MogDB/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2024/06/06/Exploring-Oracle-Compatibility-in-MogDB-Series-I-Data-Dictionary/">Exploring Oracle Compatibility in MogDB (Series I) - Data Dictionary</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2024-06-06</span>
      <p><h2 id="Install-PTK"><a href="#Install-PTK" class="headerlink" title="Install PTK"></a>Install PTK</h2><p>PTK is the optimal tool for installing the MogDB database (an enterprise-grade commercial distribution based on openGauss) or the openGauss database, offering a seamless and smooth installation experience.</p>
<p>To install PTK, simply run the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --proto <span class="string">&#x27;=https&#x27;</span> --tlsv1.2 -sSf https://cdn-mogdb.enmotech.com/ptk/install.sh | sh</span><br></pre></td></tr></table></figure>

<p>This command will automatically install PTK in the user’s home directory under <code>$HOME/.ptk</code>. This directory will serve as the working directory for PTK, storing cache files, metadata information, cluster configuration information, backup information, and other related files. Additionally, the installation command will add the path <code>$HOME/.ptk/bin</code> to the PATH environment variable in the corresponding shell profile file, enabling the user to use the <code>ptk</code> command directly after logging into the server. In this tutorial, we installed PTK using the root user, although this is not mandatory.</p>
<p>For more detailed PTK installation instructions, please refer to: <a target="_blank" rel="noopener" href="https://docs.mogdb.io/en/ptk/v1.1/install">PTK Installation Guide</a>.</p>
<p>The environment used for this series of articles is CentOS 7.6 for x86-64. MogDB must currently run on a Linux operating system. If you wish to install MogDB on macOS or Windows, you can do so using container deployment. For more information, refer to: <a target="_blank" rel="noopener" href="https://docs.mogdb.io/en/mogdb/v5.0/container-based-installation#container-based-mogdb-installation">Container-based MogDB Installation</a></p>
<p>To check your CentOS version, you can use the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat /etc/centos-release</span></span><br><span class="line">CentOS Linux release 7.6.1810 (Core)</span><br></pre></td></tr></table></figure>

<p>MogDB can also run on ARM architecture CPUs. You can list all supported CPU brands using the <code>ptk candidate cpu</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ptk candidate cpu</span></span><br><span class="line">    CPU Model</span><br><span class="line">------------------</span><br><span class="line">  Cortex-ARM64</span><br><span class="line">  Kunpeng-ARM64</span><br><span class="line">  Phythium-ARM64</span><br><span class="line">  Hygon-x64</span><br><span class="line">  Intel-x64</span><br><span class="line">  AMD-x64</span><br><span class="line">  zhaoxin-x64</span><br></pre></td></tr></table></figure>

<p>If PTK notifies you of a new version while running any command, you can upgrade it directly using the <code>ptk self upgrade</code> command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ptk ls</span></span><br><span class="line">  cluster_name | <span class="built_in">id</span> | addr | user | data_dir | db_version | create_time | comment</span><br><span class="line">---------------+----+------+------+----------+------------+-------------+----------</span><br><span class="line">Warning: New version <span class="string">&#x27;1.5.0&#x27;</span> is available, you are using ptk version <span class="string">&#x27;1.1.3&#x27;</span>.</span><br><span class="line">You can upgrade ptk via <span class="built_in">command</span>: <span class="string">&#x27;ptk self upgrade&#x27;</span></span><br><span class="line">You can also <span class="built_in">set</span> environment by <span class="string">&#x27;export PTK_NO_CHECK_VERSION=true&#x27;</span> to <span class="built_in">disable</span> this warning</span><br><span class="line"><span class="comment"># ptk self upgrade</span></span><br><span class="line">INFO[2024-06-06T11:59:01.105] current version: 1.1.3 release, target version: latest</span><br><span class="line">INFO[2024-06-06T11:59:01.105] download package from http://cdn-mogdb.enmotech.com/ptk/latest/ptk_linux_x86_64.tar.gz</span><br><span class="line">INFO[2024-06-06T11:59:01.105] downloading ptk_linux_x86_64.tar.gz ...</span><br><span class="line">&gt; ptk_linux_x86_64.tar.gz: 17.78 MiB / 20.08 MiB [-----------------------------------------------------------------------&gt;_________] 88.52% 27.93 MiB p/s ETA 0s</span><br><span class="line">&gt; ptk_linux_x86_64.tar.gz: 20.08 MiB / 20.08 MiB [---------------------------------------------------------------------------------] 100.00% 29.07 MiB p/s 900ms</span><br><span class="line">INFO[2024-06-06T11:59:02.956] upgrade ptk successfully</span><br><span class="line">[root@mogdb-kernel-0004 ~]<span class="comment"># ptk version</span></span><br><span class="line">PTK Version:    v1.5.0 release</span><br><span class="line">Go Version:     go1.19.10</span><br><span class="line">Build Date:     2024-06-04T17:16:07</span><br><span class="line">Git Hash:       edd5dbb0</span><br><span class="line">OS/Arch:        linux/amd64</span><br></pre></td></tr></table></figure>



<h2 id="Install-MogDB"><a href="#Install-MogDB" class="headerlink" title="Install MogDB"></a>Install MogDB</h2><p>With PTK, you can easily create multiple MogDB instances on a single server. Each MogDB instance can be assigned to a different operating system user, allowing you to manage multiple database instances with a single PTK installation.</p>
<p>To quickly create a test database without any configuration, you can use the <code>ptk demo</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ptk demo</span></span><br><span class="line">Cluster Name: <span class="string">&quot;demo_kVP&quot;</span></span><br><span class="line">+--------------+--------------+------------------------------+-------+---------+---------------------------------+----------+</span><br><span class="line">| az(priority) |      ip      |         user(group)          | port  |  role   |            data <span class="built_in">dir</span>             | upstream |</span><br><span class="line">+--------------+--------------+------------------------------+-------+---------+---------------------------------+----------+</span><br><span class="line">| AZ1(1)       | 172.16.0.164 | demo_user_kVP(demo_user_kVP) | 26000 | primary | /home/demo_user_kVP/demodb/data | -        |</span><br><span class="line">+--------------+--------------+------------------------------+-------+---------+---------------------------------+----------+</span><br><span class="line">✔ Is cluster config correct (default=n) [y/n]: y</span><br><span class="line">INFO[2024-06-06T12:12:05.948] start check hostname ...</span><br><span class="line">INFO[2024-06-06T12:12:05.951] check hostname success</span><br><span class="line">INFO[2024-06-06T12:12:05.951] skip check os</span><br><span class="line">INFO[2024-06-06T12:12:05.951] start check distro ...</span><br><span class="line">INFO[2024-06-06T12:12:05.972] check distro success</span><br><span class="line">[....]</span><br><span class="line">Demo Summary:</span><br><span class="line"></span><br><span class="line">Deploy Status:</span><br><span class="line"></span><br><span class="line">  cluste_name |     host     |     user      | port  |    status     | message</span><br><span class="line">--------------+--------------+---------------+-------+---------------+----------</span><br><span class="line">  demo_kVP    | 172.16.0.164 | demo_user_kVP | 26000 | start_success | success</span><br><span class="line"></span><br><span class="line">Database Detail:</span><br><span class="line"></span><br><span class="line">      item      |              value</span><br><span class="line">----------------+----------------------------------</span><br><span class="line">  user_password | Demo&amp;kVP</span><br><span class="line">  db_password   | Demo&amp;kVP</span><br><span class="line">  base_dir      | /home/demo_user_kVP/demodb</span><br><span class="line">  app_dir       | /home/demo_user_kVP/demodb/app</span><br><span class="line">  data_dir      | /home/demo_user_kVP/demodb/data</span><br><span class="line">  tool_dir      | /home/demo_user_kVP/demodb/tool</span><br><span class="line">  tmp_dir       | /home/demo_user_kVP/demodb/tmp</span><br><span class="line"></span><br><span class="line">Mode Compatibility:</span><br><span class="line"></span><br><span class="line">  mode |        database        |        plugins        |               other</span><br><span class="line">-------+------------------------+-----------------------+-------------------------------------</span><br><span class="line">  PG   | postgres_compatibility | none                  |</span><br><span class="line">  A    | oracle_compatibility   | whale[success]        |</span><br><span class="line">       |                        | compat_tools[success] |</span><br><span class="line">       |                        | mogila[success]       | db user: mogdb, password: Demo&amp;kVP</span><br><span class="line"></span><br><span class="line">Plugin Install Details:</span><br><span class="line">  mode |    plugin    | status  |                 reference                 | error</span><br><span class="line">-------+--------------+---------+-------------------------------------------+--------</span><br><span class="line">  A    | whale        | success | https://docs.mogdb.io/zh/mogdb/v3.0/whale |</span><br><span class="line">       | compat_tools | success | https://gitee.com/enmotech/compat-tools   |</span><br><span class="line">       | mogila       | success | https://gitee.com/enmotech/mogila         |</span><br></pre></td></tr></table></figure>

<p>The <code>ptk demo</code> command accomplishes the following tasks:</p>
<ol>
<li>Creates an operating system user named <code>demo_user_kVP</code>.</li>
<li>Creates a single-instance MogDB database of the latest version (currently 5.0.7).</li>
<li>Sets the database to listen on port 26000. Before running the <code>ptk demo</code> command, ensure that port 26000 is not occupied by other applications.</li>
<li>Create an initial database user with the same name as the OS user: <code>demo_user_kVP</code>. Also, create a monitor user named <code>mogdb</code>. Both users will have their initial passwords specified in the “Database Detail” section.</li>
<li>Creates two test databases: <code>oracle_compatibility</code> in Oracle-compatible mode and <code>postgres_compatibility</code> in PostgreSQL-compatible mode.</li>
<li>For the automatically created <code>oracle_compatibility</code> database, the following enhancements are also performed:<ul>
<li><p>Installs the mogila dataset. For more information about this dataset, refer to: <a target="_blank" rel="noopener" href="https://docs.mogdb.io/en/mogdb/v5.0/mogila">Using Sample Dataset Mogila</a></p>
</li>
<li><p>Installs the <code>whale</code> plugin, which provides extensive Oracle compatibility features. For more information on the Whale plugin, refer to: <a target="_blank" rel="noopener" href="https://docs.mogdb.io/en/mogdb/v5.0/whale">whale</a></p>
</li>
<li><p>Installs the <code>compat-tools</code> utility, which supplements the <code>whale</code> plugin with additional Oracle compatibility features that are not yet implemented, such as Oracle-compatible data dictionary views. For more information on <code>compat-tools</code>, refer to: <a target="_blank" rel="noopener" href="https://gitee.com/enmotech/compat-tools">enmotech&#x2F;compat-tools</a></p>
<p><strong>Note:</strong> <code>compat-tools</code> only work within a single database. This means that if you install compat-tools in the <code>oracle_compatibility</code> database (as is done automatically by the <code>ptk demo</code> command), you will only be able to query the corresponding Oracle-compatible data dictionary views when logged into that database. If you want to use these views in another database, you must install compat-tools in that database as well. For example, if you want to query Oracle-compatible data dictionary views in the <code>postgres</code> database, you need to download <code>compat-tools</code> separately from <a target="_blank" rel="noopener" href="https://gitee.com/enmotech/compat-tools">enmotech&#x2F;compat-tools</a> then run the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gsql -h 127.0.0.1 -p 26000 -d postgres -f runMe.sql</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="Exploring-Oracle-Compatible-Data-Dictionary-in-MogDB"><a href="#Exploring-Oracle-Compatible-Data-Dictionary-in-MogDB" class="headerlink" title="Exploring Oracle-Compatible Data Dictionary in MogDB"></a>Exploring Oracle-Compatible Data Dictionary in MogDB</h2><p>Switch to the operating system user associated with the demo database. You can log in to the database using the <code>gsql</code> command.</p>
<p><strong>Note:</strong> If you want to connect to the database remotely, you should use the <code>mogdb</code> user. The <code>ptk demo</code> command creates two users in the database. One starts with <code>demo_user_</code>, which is the initial user. Due to MogDB’s enhanced security features, the initial user is not allowed to connect remotely. The other user is <code>mogdb</code>, which can be used for remote connections. The initial password for the users is displayed at the end of the <code>ptk demo</code> command output. Additionally, you should modify the <code>pg_hba.conf</code> file to allow remote connections. For more information, refer to: <a target="_blank" rel="noopener" href="https://docs.mogdb.io/en/mogdb/v5.0/gsql#connecting-to-a-database-remotely">Connecting to a Database Remotely</a>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ptk ls</span></span><br><span class="line">  cluster_name |  <span class="built_in">id</span>  |        addr        |     user      |            data_dir             |          db_version          |     create_time     | comment</span><br><span class="line">---------------+------+--------------------+---------------+---------------------------------+------------------------------+---------------------+----------</span><br><span class="line">  demo_kVP     | 6001 | 172.16.0.164:26000 | demo_user_kVP | /home/demo_user_kVP/demodb/data | MogDB 5.0.7 (build c4707384) | 2024-06-06T12:12:24 |</span><br><span class="line"><span class="comment"># su - demo_user_kVP</span></span><br><span class="line">$ gsql -d oracle_compatibility -r</span><br><span class="line">gsql ((MogDB <span class="number">5.0</span>.<span class="number">7</span> build c4707384) compiled at <span class="number">2024</span>-<span class="number">05</span>-<span class="number">24</span> <span class="number">10</span>:<span class="number">51</span>:<span class="number">53</span> commit <span class="number">0</span> last mr <span class="number">1804</span> )</span><br><span class="line">Non-SSL connection (SSL connection is recommended when requiring high-security)</span><br><span class="line">Type &quot;help&quot; for help.</span><br><span class="line"></span><br><span class="line">oracle_compatibility=# \dt</span><br><span class="line">                             List of relations</span><br><span class="line"> Schema |     Name      | Type  | Owner |             Storage</span><br><span class="line">--------+---------------+-------+-------+----------------------------------</span><br><span class="line"> public | actor         | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | address       | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | category      | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | city          | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | country       | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | customer      | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | film          | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | film_actor    | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | film_category | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | inventory     | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | language      | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | payment       | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | rental        | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | staff         | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line"> public | store         | table | mogdb | &#123;orientation=row,compression=no&#125;</span><br><span class="line">(<span class="number">15</span> rows)</span><br></pre></td></tr></table></figure>

<p>All these tables come from the Mogila test dataset.</p>
<p>Compat-tools brings a large number of Oracle-compatible data dictionary views (refer to: <a target="_blank" rel="noopener" href="https://gitee.com/enmotech/compat-tools#oracle-compatibility-views">Oracle-Compatible Views</a>). Here are some simple examples.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- sysdate function and dual table is supported</span></span><br><span class="line">oracle_compatibility<span class="operator">=</span># <span class="keyword">select</span> sysdate <span class="keyword">from</span> dual;</span><br><span class="line">       sysdate</span><br><span class="line"><span class="comment">---------------------</span></span><br><span class="line"> <span class="number">2024</span><span class="number">-06</span><span class="number">-06</span> <span class="number">12</span>:<span class="number">47</span>:<span class="number">57</span></span><br><span class="line">(<span class="number">1</span> <span class="type">row</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- V$ views are supported</span></span><br><span class="line">oracle_compatibility<span class="operator">=</span># <span class="keyword">select</span> sid,username,status,program <span class="keyword">from</span> v$session;</span><br><span class="line">      sid       <span class="operator">|</span>   username    <span class="operator">|</span> status <span class="operator">|</span>        program</span><br><span class="line"><span class="comment">----------------+---------------+--------+------------------------</span></span><br><span class="line"> <span class="number">47724487509760</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> active <span class="operator">|</span> gsql</span><br><span class="line"> <span class="number">47724085905152</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> idle   <span class="operator">|</span> WLMArbiter</span><br><span class="line"> <span class="number">47724057593600</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> idle   <span class="operator">|</span> WorkloadMonitor</span><br><span class="line"> <span class="number">47724032427776</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> active <span class="operator">|</span> workload</span><br><span class="line"> <span class="number">47723769759488</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> active <span class="operator">|</span> Asp</span><br><span class="line"> <span class="number">47723818518272</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> idle   <span class="operator">|</span> statement flush thread</span><br><span class="line"> <span class="number">47723696359168</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> idle   <span class="operator">|</span> CfsShrinker</span><br><span class="line"> <span class="number">47723730437888</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> idle   <span class="operator">|</span> WDRSnapshot</span><br><span class="line"> <span class="number">47723597268736</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> idle   <span class="operator">|</span> ApplyLauncher</span><br><span class="line"> <span class="number">47723658610432</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> idle   <span class="operator">|</span> TxnSnapCapturer</span><br><span class="line"> <span class="number">47723563190016</span> <span class="operator">|</span> demo_user_kVP <span class="operator">|</span> active <span class="operator">|</span> JobScheduler</span><br><span class="line">(<span class="number">11</span> <span class="keyword">rows</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- DBA_ views are supported</span></span><br><span class="line">oracle_compatibility<span class="operator">=</span># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dba_users;</span><br><span class="line">   username    <span class="operator">|</span> user_id <span class="operator">|</span> password <span class="operator">|</span> account_status <span class="operator">|</span> lock_date <span class="operator">|</span> expiry_date <span class="operator">|</span>   profile</span><br><span class="line"><span class="comment">---------------+---------+----------+----------------+-----------+-------------+--------------</span></span><br><span class="line"> demo_user_kVP <span class="operator">|</span>      <span class="number">10</span> <span class="operator">|</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="operator">|</span> NORMAL         <span class="operator">|</span>           <span class="operator">|</span>             <span class="operator">|</span> DEFAULT_POOL</span><br><span class="line"> MOGDB         <span class="operator">|</span>   <span class="number">18720</span> <span class="operator">|</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="operator">|</span> NORMAL         <span class="operator">|</span>           <span class="operator">|</span>             <span class="operator">|</span> DEFAULT_POOL</span><br><span class="line">(<span class="number">2</span> <span class="keyword">rows</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- USER_ views are supported</span></span><br><span class="line">oracle_compatibility<span class="operator">=</span># <span class="keyword">select</span> table_name,num_rows,last_analyzed <span class="keyword">from</span> user_tables;</span><br><span class="line">  table_name   <span class="operator">|</span> num_rows <span class="operator">|</span>         last_analyzed</span><br><span class="line"><span class="comment">---------------+----------+-------------------------------</span></span><br><span class="line"> COUNTRY       <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> CITY          <span class="operator">|</span>      <span class="number">600</span> <span class="operator">|</span> <span class="number">2024</span><span class="number">-06</span><span class="number">-06</span> <span class="number">12</span>:<span class="number">13</span>:<span class="number">24.504009</span><span class="operator">+</span><span class="number">08</span></span><br><span class="line"> ACTOR         <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> FILM_ACTOR    <span class="operator">|</span>     <span class="number">5462</span> <span class="operator">|</span> <span class="number">2024</span><span class="number">-06</span><span class="number">-06</span> <span class="number">12</span>:<span class="number">13</span>:<span class="number">24.518718</span><span class="operator">+</span><span class="number">08</span></span><br><span class="line"> CATEGORY      <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> FILM_CATEGORY <span class="operator">|</span>     <span class="number">1000</span> <span class="operator">|</span> <span class="number">2024</span><span class="number">-06</span><span class="number">-06</span> <span class="number">12</span>:<span class="number">13</span>:<span class="number">24.531421</span><span class="operator">+</span><span class="number">08</span></span><br><span class="line"> <span class="keyword">LANGUAGE</span>      <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> FILM          <span class="operator">|</span>     <span class="number">1000</span> <span class="operator">|</span> <span class="number">2024</span><span class="number">-06</span><span class="number">-06</span> <span class="number">12</span>:<span class="number">13</span>:<span class="number">24.56158</span><span class="operator">+</span><span class="number">08</span></span><br><span class="line"> PAYMENT       <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> CUSTOMER      <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> INVENTORY     <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> RENTAL        <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> STAFF         <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> ADDRESS       <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"> STORE         <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span></span><br><span class="line">(<span class="number">15</span> <span class="keyword">rows</span>)</span><br><span class="line"></span><br><span class="line">oracle_compatibility<span class="operator">=</span># <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> CITY;</span><br><span class="line"> count</span><br><span class="line"><span class="comment">-------</span></span><br><span class="line">   <span class="number">600</span></span><br><span class="line">(<span class="number">1</span> <span class="type">row</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- some short name views are supported, like IND, OBJ, COLS </span></span><br><span class="line">oracle_compatibility<span class="operator">=</span># <span class="keyword">select</span> index_name,table_owner,uniqueness,distinct_keys,partitioned <span class="keyword">from</span> ind <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;CITY&#x27;</span>;</span><br><span class="line">    index_name     <span class="operator">|</span> table_owner <span class="operator">|</span> uniqueness <span class="operator">|</span> distinct_keys <span class="operator">|</span> partitioned</span><br><span class="line"><span class="comment">-------------------+-------------+------------+---------------+-------------</span></span><br><span class="line"> CITY_PKEY         <span class="operator">|</span> PUBLIC      <span class="operator">|</span> <span class="keyword">UNIQUE</span>     <span class="operator">|</span>           <span class="number">600</span> <span class="operator">|</span> <span class="keyword">NO</span></span><br><span class="line"> IDX_FK_COUNTRY_ID <span class="operator">|</span> PUBLIC      <span class="operator">|</span> NONUNIQUE  <span class="operator">|</span>           <span class="number">109</span> <span class="operator">|</span> <span class="keyword">NO</span></span><br><span class="line">(<span class="number">2</span> <span class="keyword">rows</span>)</span><br></pre></td></tr></table></figure>

<p><strong>Note:</strong> Due to significant differences in the underlying structure between MogDB and Oracle, these Oracle-compatible views may not include all the fields present in the corresponding Oracle database views.</p>
<p><strong>To be continued:</strong></p>
<p>- Exploring Oracle Compatibility in MogDB (Series II) - System Functions</p>
<p>- Exploring Oracle Compatibility in MogDB (Series III) - DBMS Packages</p>
</p>
      <div class="post-button"><a class="btn" href="/2024/06/06/Exploring-Oracle-Compatibility-in-MogDB-Series-I-Data-Dictionary/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2024/06/05/Working-Mechanism-of-synchronous-standby-names-in-MogDB/">Working Mechanism of synchronous_standby_names in MogDB</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2024-06-05</span>
      <p><p>In MogDB, the parameter <code>synchronous_standby_names</code> is used to configure synchronous replication settings. When this parameter is set to <code>&#39;*&#39;</code>（default setting）, it indicates that any available standby server can be used as a synchronous standby. This configuration allows any currently connected standby to be utilized as a synchronous standby without explicitly specifying the standby’s name.</p>
<h3 id="Working-Mechanism"><a href="#Working-Mechanism" class="headerlink" title="Working Mechanism"></a>Working Mechanism</h3><p>When <code>synchronous_standby_names</code> is set to <code>&#39;*&#39;</code>, MogDB’s synchronous replication mechanism selects the synchronous standby through the following steps:</p>
<ol>
<li><p><strong>Initial Connection</strong>: When the primary server starts or the parameter is changed, the primary server accepts all connected standby servers.</p>
</li>
<li><p><strong>Synchronous Standby Confirmation</strong>:</p>
<ul>
<li>The primary server sends a synchronization request to all connected standby servers.</li>
<li>Each standby server, upon receiving the request, confirms it and reports its status back to the primary server.</li>
</ul>
</li>
<li><p><strong>Selecting the Synchronous Standby</strong>:</p>
<ul>
<li>The primary server selects the earliest responding standby server(s) as the synchronous standby.</li>
<li>This selection process is dynamic, meaning that if new standbys connect or current synchronous standbys disconnect, the primary server will reselect the synchronous standby.</li>
</ul>
</li>
</ol>
<h3 id="Priority-and-Behavior"><a href="#Priority-and-Behavior" class="headerlink" title="Priority and Behavior"></a>Priority and Behavior</h3><ul>
<li><strong>No Priority Order</strong>: Since <code>&#39;*&#39;</code> denotes any standby, all standbys have the same priority. The primary server simply selects the earliest responding standby as the synchronous standby.</li>
<li><strong>Dynamic Adjustment</strong>: If a synchronous standby disconnects, the primary server automatically selects the next responding standby as the new synchronous standby, ensuring the continuity and reliability of synchronous replication.</li>
<li><strong>Concurrent Management</strong>: If multiple standbys connect simultaneously, the primary server can handle these concurrent connections and select the synchronous standby based on the confirmation of synchronization requests.</li>
</ul>
<h3 id="Configuration-Example-and-Usage"><a href="#Configuration-Example-and-Usage" class="headerlink" title="Configuration Example and Usage"></a>Configuration Example and Usage</h3><p>Suppose we have one primary server and three standby servers (<code>standby1</code>, <code>standby2</code>, and <code>standby3</code>). In the configuration file <code>postgresql.conf</code>, set <code>synchronous_standby_names</code> to <code>&#39;*&#39;</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronous_standby_names = &#x27;*&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="Scenario-Analysis"><a href="#Scenario-Analysis" class="headerlink" title="Scenario Analysis"></a>Scenario Analysis</h4><ol>
<li><p><strong>Selection at Startup</strong>:</p>
<ul>
<li>When the primary server starts, all connected standby servers send heartbeat signals and wait for the primary server’s synchronization request.</li>
<li>The primary server selects the earliest responding standby as the synchronous standby.</li>
</ul>
</li>
<li><p><strong>Runtime Changes</strong>:</p>
<ul>
<li>If the current synchronous standby <code>standby1</code> disconnects, the primary server automatically selects the next responding standby <code>standby2</code> as the new synchronous standby.</li>
<li>If a new standby <code>standby3</code> connects to the primary server and there is no current synchronous standby, the primary server selects <code>standby3</code> as the synchronous standby.</li>
</ul>
</li>
</ol>
<h4 id="Dynamic-Adjustment"><a href="#Dynamic-Adjustment" class="headerlink" title="Dynamic Adjustment"></a>Dynamic Adjustment</h4><p>If we start the primary server and three standby servers, setting <code>synchronous_standby_names = &#39;*&#39;</code>, the following state transitions are possible:</p>
<ul>
<li><strong>Initial State</strong>: All standbys (<code>standby1</code>, <code>standby2</code>, and <code>standby3</code>) connect, and the primary server selects the earliest responding standby <code>standby1</code> as the synchronous standby.</li>
<li><strong><code>standby1</code> Disconnects</strong>: The primary server automatically selects the next responding standby <code>standby2</code> as the new synchronous standby.</li>
<li><strong>New Standby Connection</strong>: A new standby <code>standby4</code> connects; the primary server will not change the current synchronous standby unless <code>standby2</code> disconnects.</li>
</ul>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>When <code>synchronous_standby_names</code> is set to <code>&#39;*&#39;</code>, MogDB dynamically selects any currently available standby as the synchronous standby. This provides a flexible and highly available synchronous replication mechanism without requiring administrators to manually specify the standby names. The selection process is based on standby response times and automatically adjusts during runtime to ensure the continuity and reliability of synchronous replication.</p>
</p>
      <div class="post-button"><a class="btn" href="/2024/06/05/Working-Mechanism-of-synchronous-standby-names-in-MogDB/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>
  <div class="lx-entry padding">
    <div>
      <h2 class="title"><a href="/2024/06/03/MTK-The-Ultimate-Tool-for-Seamlessly-Migrating-Oracle-Databases-to-MogDB/">MTK: The Ultimate Tool for Seamlessly Migrating Oracle Databases to MogDB</a></h2>
      <span class="lx-post-detail"><i class="fa fa-calendar-o"></i> 2024-06-03</span>
      <p><h2 id="Get-the-latest-version-MTK"><a href="#Get-the-latest-version-MTK" class="headerlink" title="Get the latest version MTK."></a>Get the latest version MTK.</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://cdn-mogdb.enmotech.com/mtk/v2.6.3/mtk_2.6.3_linux_amd64.tar.gz</span><br><span class="line">tar -xvf mtk_2.6.3_linux_amd64.tar.gz</span><br></pre></td></tr></table></figure>



<h2 id="Generate-MTK-trial-license-online"><a href="#Generate-MTK-trial-license-online" class="headerlink" title="Generate MTK trial license online"></a>Generate MTK trial license online</h2><p>The trial license is valid for 1 month, and each email address can generate only one license. However, email addresses with the “enmotech.com” domain can generate licenses repeatedly. If clients wish to extend their trial of MTK beyond the initial month, they should contact Enmotech’s sales or pre-sales team to request an additional 1-month license.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[kamus@altlinux10 mtk_2.6.3_linux_amd64]$ ./mtk license gen</span><br><span class="line">License File Not Found (default license.json)</span><br><span class="line">The License code is invalid, start applying</span><br><span class="line">✔ Email: kamus@enmotech.com█</span><br><span class="line">Start applying for email kamus@enmotech.com authorization.</span><br><span class="line">Start parsing the interface to return data.</span><br><span class="line">Successful application for authorization. Please check the mail and save it as license.json.</span><br></pre></td></tr></table></figure>

<p>Upon receiving the email, upload the attached license.json file to the MTK directory. Then, use the command mtk -v to verify the license validation.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[kamus@altlinux10 mtk_2.6.3_linux_amd64]$ ./mtk -v</span><br><span class="line">Using license file: /home/kamus/mogdb-tools/mtk_2.6.3_linux_amd64/license.json</span><br><span class="line">Name: kamus@enmotech.com</span><br><span class="line">Expiry: 2022-10-24 12:08:58.751194162 +0800 +0800</span><br><span class="line">License key verified!</span><br><span class="line">License checks OK!</span><br><span class="line"></span><br><span class="line">MMMMMMMM               MMMMMMMMTTTTTTTTTTTTTTTTTTTTTTTKKKKKKKKK    KKKKKKK</span><br><span class="line">M:::::::M             M:::::::MT:::::::::::::::::::::TK:::::::K    K:::::K</span><br><span class="line">M::::::::M           M::::::::MT:::::::::::::::::::::TK:::::::K    K:::::K</span><br><span class="line">M:::::::::M         M:::::::::MT:::::TT:::::::TT:::::TK:::::::K   K::::::K</span><br><span class="line">M::::::::::M       M::::::::::MTTTTTT  T:::::T  TTTTTTKK::::::K  K:::::KKK</span><br><span class="line">M:::::::::::M     M:::::::::::M        T:::::T          K:::::K K:::::K</span><br><span class="line">M:::::::M::::M   M::::M:::::::M        T:::::T          K::::::K:::::K</span><br><span class="line">M::::::M M::::M M::::M M::::::M        T:::::T          K:::::::::::K</span><br><span class="line">M::::::M  M::::M::::M  M::::::M        T:::::T          K:::::::::::K</span><br><span class="line">M::::::M   M:::::::M   M::::::M        T:::::T          K::::::K:::::K</span><br><span class="line">M::::::M    M:::::M    M::::::M        T:::::T          K:::::K K:::::K</span><br><span class="line">M::::::M     MMMMM     M::::::M        T:::::T        KK::::::K  K:::::KKK</span><br><span class="line">M::::::M               M::::::M      TT:::::::TT      K:::::::K   K::::::K</span><br><span class="line">M::::::M               M::::::M      T:::::::::T      K:::::::K    K:::::K</span><br><span class="line">M::::::M               M::::::M      T:::::::::T      K:::::::K    K:::::K</span><br><span class="line">MMMMMMMM               MMMMMMMM      TTTTTTTTTTT      KKKKKKKKK    KKKKKKK</span><br><span class="line"></span><br><span class="line">Release version: v2.6.3</span><br><span class="line">Git Commit hash: da0ed8ee</span><br><span class="line">Git Commit Date: 2022-09-22T01:17:49Z</span><br><span class="line">Git Tag        : v2.6.3</span><br><span class="line">Build timestamp: 20220922011907</span><br></pre></td></tr></table></figure>



<h2 id="Install-Oracle-instant-client"><a href="#Install-Oracle-instant-client" class="headerlink" title="Install Oracle instant client"></a>Install Oracle instant client</h2><p>MTK requires the <a target="_blank" rel="noopener" href="https://www.oracle.com/database/technologies/instant-client/downloads.html">Oracle Instant Client</a> to migrate Oracle objects to MogDB. In this tutorial, we will download the <a target="_blank" rel="noopener" href="https://download.oracle.com/otn_software/linux/instantclient/217000/instantclient-basic-linux.x64-21.7.0.0.0dbru.zip">Oracle Instant Client for Linux x86-64 Basic Package</a>. After downloading, unzip the file and set the <code>LD_LIBRARY_PATH</code> parameter as follows:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=/home/kamus/instantclient_21_7:<span class="variable">$LD_LIBRARY_PATH</span></span><br></pre></td></tr></table></figure>

<p>In this tutorial, we will migrate a sample schema “customer_orders” to MogDB. The scripts for Oracle can be downloaded from the <a target="_blank" rel="noopener" href="https://github.com/oracle-samples/db-sample-schemas">db-sample-schemas</a> repository on GitHub.</p>
<p><img src="https://s2.loli.net/2022/09/24/mKnfuY28shRNI9X.png" alt="image-20220924140451621"></p>
<h2 id="Initialize-migration-project"><a href="#Initialize-migration-project" class="headerlink" title="Initialize migration project"></a>Initialize migration project</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./mtk init-project -s oracle -t mogdb -n ora2mogdb</span><br></pre></td></tr></table></figure>



<h2 id="Modify-MTK-configuration-file"><a href="#Modify-MTK-configuration-file" class="headerlink" title="Modify MTK configuration file"></a>Modify MTK configuration file</h2><p>Modify the example MTK configuration file stored in the <code>project_name_dir/config</code> directory. Refer to the <a target="_blank" rel="noopener" href="https://docs.mogdb.io/en/mtk/v2.0/mtk-parameter">MTK documentation</a> for detailed information on each parameter. The essential configuration sections for MTK are <code>source</code>, <code>target</code>, and <code>object</code>.</p>
<ul>
<li><p><strong><code>source</code> section</strong>: This defines the connection to the source database. MTK needs to query the Oracle database dictionary to retrieve DDL. Therefore, it is typically recommended to use a DBA user, with the default system user being sufficient.</p>
</li>
<li><p><strong><code>target</code> section</strong>: This defines the connection to the target database.</p>
</li>
<li><p><strong><code>object</code> section</strong>: To migrate all objects within a schema, simply specify the schema name in the <code>schemas</code> section.</p>
</li>
</ul>
<p>The <code>mtk.json</code> configuration file should look like this:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;oracle&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;connect&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;119.3.182.31&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;user&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="number">15221</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;oracle&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;dbName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ORACLE21C&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;charset&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;clientCharset&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mogdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;connect&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;127.0.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;user&quot;</span><span class="punctuation">:</span> <span class="string">&quot;co&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="number">26000</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Enmo@123&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;dbName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;postgres&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;charset&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;clientCharset&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;tables&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;schemas&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;co&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;excludeTable&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;tableSplit&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dataOnly&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;schemaOnly&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>For this tutorial, we plan to migrate all objects in the “CO” schema from the Oracle database to the same user in MogDB. For testing purposes, we will not create a new database in MogDB. Instead, we will create a new user “co” in the default database, <code>postgres</code>.</p>
<p>Run the following command to create the user:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[omm@altlinux10 ~]$ gsql -d postgres -p 26000 -r</span><br><span class="line">gsql ((MogDB <span class="number">3.0</span>.<span class="number">2</span> build <span class="number">9</span>bc79be5) compiled at <span class="number">2022</span>-<span class="number">09</span>-<span class="number">18</span> <span class="number">00</span>:<span class="number">37</span>:<span class="number">49</span> commit <span class="number">0</span> last mr  )</span><br><span class="line">Non-SSL connection (SSL connection is recommended when requiring high-security)</span><br><span class="line">Type &quot;help&quot; for help.</span><br><span class="line"></span><br><span class="line">MogDB=# create user co identified by &quot;Enmo@<span class="number">123</span>&quot;;</span><br><span class="line">CREATE ROLE</span><br></pre></td></tr></table></figure>



<h2 id="Start-migration"><a href="#Start-migration" class="headerlink" title="Start migration"></a>Start migration</h2><p>Now, we can start migration.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./mtk -c ora2mogdb/config/mtk.json</span><br></pre></td></tr></table></figure>



<h2 id="Check-migration-report"><a href="#Check-migration-report" class="headerlink" title="Check migration report"></a>Check migration report</h2><p>The migration result report will be generated in the project report directory, available in both plain text and HTML formats. For simplicity, I have included the text format result in this tutorial.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-----------------------</span><br><span class="line">ObjectName Type Summary</span><br><span class="line">-----------------------</span><br><span class="line"></span><br><span class="line">+------------------+-------------------+-------------------+--------+-----------+-------------+-------------+-------------+--------------------|-------------+</span><br><span class="line">|       Type       |     StartTime     |      EndTime      | Status | Total Num | Success Num | Warring Num | Failed  Num |Failed(Invalid) Num | Time        |</span><br><span class="line">+------------------+-------------------+-------------------+--------+-----------+-------------+-------------+-------------+--------------------|-------------+</span><br><span class="line">|Schema            |2022-09-24 15:12:36|2022-09-24 15:12:36|finish  |1          |1            |0            |0            |0                   |282 ms       ｜</span><br><span class="line">|Sequence          |2022-09-24 15:12:36|2022-09-24 15:12:36|finish  |0          |0            |0            |0            |0                   |210 ms       ｜</span><br><span class="line">|ObjectType        |2022-09-24 15:12:36|2022-09-24 15:12:36|finish  |0          |0            |0            |0            |0                   |356 ms       ｜</span><br><span class="line">|Queue             |2022-09-24 15:12:36|2022-09-24 15:12:37|finish  |0          |0            |0            |0            |0                   |177 ms       ｜</span><br><span class="line">|Table             |2022-09-24 15:12:37|2022-09-24 15:12:47|finish  |7          |7            |0            |0            |0                   |9 s 952 ms   ｜</span><br><span class="line">|TableData         |2022-09-24 15:12:47|2022-09-24 15:12:53|finish  |7          |7            |0            |0            |0                   |6 s 743 ms   ｜</span><br><span class="line">|Index             |2022-09-24 15:12:53|2022-09-24 15:12:53|finish  |7          |7            |0            |0            |0                   |1 ms         ｜</span><br><span class="line">|Constraint        |2022-09-24 15:12:53|2022-09-24 15:12:53|finish  |24         |23           |0            |1            |0                   |51 ms        ｜</span><br><span class="line">|DBLink            |2022-09-24 15:12:53|2022-09-24 15:12:53|finish  |0          |0            |0            |0            |0                   |67 ms        ｜</span><br><span class="line">|View              |2022-09-24 15:12:53|2022-09-24 15:12:54|finish  |4          |2            |0            |2            |0                   |723 ms       ｜</span><br><span class="line">|MaterializedView  |2022-09-24 15:12:54|2022-09-24 15:12:54|finish  |0          |0            |0            |0            |0                   |138 ms       ｜</span><br><span class="line">|Function          |2022-09-24 15:12:54|2022-09-24 15:12:54|finish  |0          |0            |0            |0            |0                   |113 ms       ｜</span><br><span class="line">|Procedure         |2022-09-24 15:12:54|2022-09-24 15:12:55|finish  |0          |0            |0            |0            |0                   |109 ms       ｜</span><br><span class="line">|Package           |2022-09-24 15:12:55|2022-09-24 15:12:55|finish  |0          |0            |0            |0            |0                   |77 ms        ｜</span><br><span class="line">|Trigger           |2022-09-24 15:12:55|2022-09-24 15:12:55|finish  |0          |0            |0            |0            |0                   |404 ms       ｜</span><br><span class="line">|Synonym           |2022-09-24 15:12:55|2022-09-24 15:12:55|finish  |0          |0            |0            |0            |0                   |74 ms        ｜</span><br><span class="line">|TableDataCom      |2022-09-24 15:12:55|2022-09-24 15:12:56|finish  |7          |7            |0            |0            |0                   |810 ms       ｜</span><br><span class="line">|AlterSequence     |2022-09-24 15:12:56|2022-09-24 15:12:56|finish  |0          |0            |0            |0            |0                   |71 ms        ｜</span><br><span class="line">|CollStatistics    |2022-09-24 15:12:56|2022-09-24 15:12:56|finish  |7          |7            |0            |0            |0                   |29 ms        ｜</span><br><span class="line">+------------------+-------------------+-------------------+--------+-----------+-------------+-------------+-------------+--------------------|-------------+</span><br></pre></td></tr></table></figure>



<p>We can see that all tables and table data have been successfully migrated to MogDB without any errors. However, there is one failed constraint and two failed views.</p>
<p>The failed constraint is a JSON check constraint, which is not supported by MogDB.</p>
<p><img src="https://s2.loli.net/2022/09/24/RDKmsNFvroWTPgZ.png" alt="image-20220924153609138"></p>
<p>The failed views are due to the <code>grouping_id</code> function and the <code>json_table</code> function, which are not yet implemented in MogDB ().</p>
<table>
<thead>
<tr>
<th>SQL</th>
<th>ERROR</th>
</tr>
</thead>
<tbody><tr>
<td><img src="https://s2.loli.net/2022/09/24/4BMfnQ6alrqhvd8.png" alt="image-20220924154621375"></td>
<td>pq: function grouping_id(character varying, character varying) does not exist</td>
</tr>
<tr>
<td><img src="https://s2.loli.net/2022/09/24/D6kHROy3vFULnQA.png" alt="image-20220924154529308"></td>
<td>pq: syntax error at or near “columns”</td>
</tr>
</tbody></table>
<h2 id="Check-migration-result"><a href="#Check-migration-result" class="headerlink" title="Check migration result"></a>Check migration result</h2><p>Run the sample queries to ensure that all the data has been migrated to MogDB without any errors.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/* 5 products with the highest revenue</span><br><span class="line">   With their corresponding order rank */</span><br><span class="line">select p.product_name, </span><br><span class="line">       count(*) number_of_orders,</span><br><span class="line">       sum ( oi.quantity * oi.unit_price ) total_value,</span><br><span class="line">       rank () over ( </span><br><span class="line">         order by count(*) desc </span><br><span class="line">       ) order_count_rank</span><br><span class="line">from   products p</span><br><span class="line">join   order_items oi</span><br><span class="line">on     p.product_id = oi.product_id</span><br><span class="line">group  by p.product_name</span><br><span class="line">order  by sum ( oi.quantity * oi.unit_price ) desc</span><br><span class="line">fetch  first 5 rows only;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MogDB=&gt; select p.product_name,</span><br><span class="line">MogDB-&gt;        count(*) number_of_orders,</span><br><span class="line">MogDB-&gt;        sum ( oi.quantity * oi.unit_price ) total_value,</span><br><span class="line">MogDB-&gt;        rank () over (</span><br><span class="line">MogDB(&gt;          order by sum ( oi.quantity * oi.unit_price ) desc</span><br><span class="line">MogDB(&gt;        ) revenue_rank</span><br><span class="line">MogDB-&gt; from   products p</span><br><span class="line">MogDB-&gt; join   order_items oi</span><br><span class="line">MogDB-&gt; on     p.product_id = oi.product_id</span><br><span class="line">MogDB-&gt; group  by p.product_name</span><br><span class="line">MogDB-&gt; order  by count(*) desc</span><br><span class="line">MogDB-&gt; fetch  first 5 rows only;</span><br><span class="line">     product_name      | number_of_orders | total_value | revenue_rank</span><br><span class="line">-----------------------+------------------+-------------+--------------</span><br><span class="line"> Girl&#x27;s Trousers (Red) |              148 |    15794.76 |            1</span><br><span class="line"> Boy&#x27;s Hoodie (Grey)   |              100 |     3754.08 |           35</span><br><span class="line"> Men&#x27;s Pyjamas (Blue)  |              100 |     3274.61 |           36</span><br><span class="line"> Men&#x27;s Coat (Red)      |               98 |     4230.30 |           31</span><br><span class="line"> Boy&#x27;s Socks (White)   |               98 |     3081.12 |           38</span><br><span class="line">(5 rows)</span><br></pre></td></tr></table></figure>



<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Migrating tables, table data, and indexes from Oracle to MogDB typically proceeds without issues. However, for views, procedures, functions, and packages, some modifications to the source code may be necessary. With the ongoing development of Oracle compatibility in MogDB, we believe that the need for such modifications will decrease over time, making the migration process from Oracle to MogDB even smoother.</p>
</p>
      <div class="post-button"><a class="btn" href="/2024/06/03/MTK-The-Ultimate-Tool-for-Seamlessly-Migrating-Oracle-Databases-to-MogDB/" rel="noopener"><i class="fa fa-angle-double-right fa-fw"></i>Read More</a></div>
    </div>
  </div>


<div id="pagination">
  <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"></a>
</div>

<footer>
  <div>
  Copyright &copy; 2025.<a href="/">Kamus' Notes</a><br>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme <a href="https://lx.js.org" target="_blank">Lx</a><br>
  </div>
</footer>

  </div>
</div>
</div>

<button class="hamburger hamburger--arrow-r" type="button" title="menu">
    <div class="hamburger-box">
      <div class="hamburger-inner"></div>
    </div>
</button>
<div class="menu visibility">
  <div class="menu-head">
    <span class="layer">
      <div class="col">
        <div class="row for-pic">
          <div class="profile-pic">
            <a href="/"><img src="https://s2.loli.net/2024/05/27/nuGfQUOx6kR9YIh.png" alt="Kamus"/></a>
          </div>
        </div>
        <div class="row for-name">
          <p>Kamus</p>
          <span class="tagline">Hello, World!</span>
        </div>
      </div>
    </span>
  </div>
  <nav class="menu-container">
  <ul class="menu-items">
    <li><a href="/"><i class="fa fa-home fa-fw"></i>Home</a></li>
    <li><a href="/archives/"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
    
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-bookmark fa-fw"></i>Pages</span>
        <ul>
          <li><a href="/about/">About</a></li>
        </ul>
    </li>
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-link fa-fw"></i>Friends</span>
        <ul>
          <li> <a href="https://www.eygle.com/" target="_blank">Eygle</a></li>
        <li> <a href="https://yangtingkun.net" target="_blank">Laoyang</a></li>
        </ul>
    </li>
  </ul>
  </nav>
</div>

<div class="gototop js-top">
  <a href="#" class="js-gotop"><i class="fa fa-arrow-up"></i></a>
</div>
<script src="https://cdn.jsdelivr.net/npm/theme-lx@0.4.4/source/dist/js/jquery.easing.min.js"></script>
<script>
(function () {
	"use strict";
	var goToTop = function() {
		$(".js-gotop").on("click", function(event){
			event.preventDefault();
			$("html, body").animate({
				scrollTop: $("html").offset().top
			}, 500, "easeInOutExpo");
			return false;
		});
		$(window).scroll(function(){
			var $win = $(window);
			if ($win.scrollTop() > 200) {
				$(".js-top").addClass("active");
			} else {
				$(".js-top").removeClass("active");
			}
		});
	};
	$(function(){
		goToTop();
	});
}());
</script>
<script src="https://cdn.jsdelivr.net/npm/theme-lx@0.4.4/source/dist/js/local.search.min.js"></script>

</body>
</html>
